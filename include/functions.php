<?phpfunction returnSubstrings($text, $openingMarker, $closingMarker) {    $openingMarkerLength = strlen($openingMarker);    $closingMarkerLength = strlen($closingMarker);    $result = array();    $position = 0;    while (($position = strpos($text, $openingMarker, $position)) !== false)    {        $position += $openingMarkerLength;        if (($closingMarkerPosition = strpos($text, $closingMarker, $position)) !== false) {            $result[] = substr($text, $position, $closingMarkerPosition - $position);            $position = $closingMarkerPosition + $closingMarkerLength;        }    }    return $result;}function language ($page) //смотрим ланг, и заменяем в шаблоне все соответственно выбраному лангу{    global $config;    /*if (file_exists ($lang))    {        require_once ($lang);    } else {        require ($config ['default_language_admin']);    }*/    global $lang;    //$lang_replace = returnSubstrings($page, '{lang_', '}');    $titre = preg_match_all("|{lang_(.*)}|isU",$page,$regs);    $lang_replace = $regs[1];    foreach ($lang_replace as $v)    {        $page = str_replace ("{lang_".$v."}", $lang[$v], $page);    }    return ($page);}function get_user_info_by_login ($login) //возвращаем информацию о пользователе по указаному логину{    $sql = "SELECT * FROM ls_users where login='$login';";    $result = mysql_query($sql);    return (mysql_fetch_array($result, MYSQL_ASSOC));}function return_my_language () //получаем настройки языков с кукиксов, если таковы имеются, и возвращаем массив файлов языков, которые пожже проинклудим{    global $config;    if (isset ($_COOKIE['lang']) or isset ($_GET['lang']))    {        if (isset ($_GET['lang']))        {            $lang_req = $_GET['lang'];        } else {            $lang_req = $_COOKIE['lang'];        }        switch($lang_req)        {            case "ru":                $array[0] = ($config ['default_path'].'admin/languages/ru.php');                $array[1] = ($config ['default_path'].'languages/ru.php');                break;            case "ua":                $array[0] = ($config ['default_path'].'admin/languages/ua.php');                $array[1] = ($config ['default_path'].'languages/ua.php');                break;        }    } else {        $array[0] = ($config ['default_path'].'admin/'.$config ['default_language_admin']);        $array[1] = ($config ['default_path'].$config ['default_language_sait']);    }    return($array);}function return_info_for_lang_for_alt_name ($alt_name)//возвращаем информацию о языке по указателю{    $sql = "SELECT * FROM ls_lang where alt_name='$alt_name';";    $result = mysql_query($sql);    return (mysql_fetch_array($result, MYSQL_ASSOC));}function return_all_ok_lang () //Возвращаем все проинициализированные языки, и которые включены{    $results = mysql_query("SELECT * FROM ls_lang where active=1;");    $number = mysql_num_rows ($results);    for ($i=0; $i<$number; $i++)    {        $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);    }    return ($array);}function getArray($sql){    $results = mysql_query($sql);    $number = mysql_num_rows ($results);    if ($number){        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        return ($array);    } else {        return(false);    }}function getOneString($sql){    if ($info = mysql_fetch_array(mysql_query($sql), MYSQL_ASSOC)){        return ($info);    } else {        return (false);    }}function getOneValue($id){    if ($info = getOneString("SELECT `ls_params_select_values`.* , `ls_translate`.`text` FROM `ls_params_select_values` JOIN `ls_translate` ON `ls_params_select_values`.`id` = `ls_translate`.`id_elements` WHERE `ls_translate`.`type` = 'select_value' and `ls_params_select_values`.`id` = '".$id."';")){        return ($info);    } else {        return (false);    }}function getOneValueText($id){    if ($info = getOneString("SELECT `ls_params_select_values`.* , `ls_translate`.`text` FROM `ls_params_select_values` JOIN `ls_translate` ON `ls_params_select_values`.`id` = `ls_translate`.`id_elements` WHERE `ls_translate`.`type` = 'select_value' and `ls_params_select_values`.`id` = '".$id."';")){        return ($info['text']);    } else {        return (false);    }}function return_select_lang ($page_location, $width='90px', $color='#F5FAF8', $alfa='#FFFFFF'){    global $lang, $config;    $html_lang = '';    $return_all_ok_lang = return_all_ok_lang();    if (count ($return_all_ok_lang)>0)    {        foreach ($return_all_ok_lang as $v)        {            if (substr_count($page_location, '?'))            {                $link = $page_location.'&lang='.$v['alt_name'];            } else {                $link = $page_location.'?lang='.$v['alt_name'];            }            $html_lang .= '<li><a href="'.$link.'"><img src="'.$config ['site_url'].'images/languages/icon/'.$v['alt_name'].'.png" width="14"> '.$v['name'].'</a></li>';        }    }    $html_lang_select = '	<script>	var timeout    = 300;	var closetimer = 0;	var ddmenuitem = 0;	function jsddm_open()	{  jsddm_canceltimer();	jsddm_close();	ddmenuitem = $(this).find(\'ul\').css(\'visibility\', \'visible\');}	function jsddm_close()	{  if(ddmenuitem) ddmenuitem.css(\'visibility\', \'hidden\');}	function jsddm_timer()	{  closetimer = window.setTimeout(jsddm_close, timeout);}	function jsddm_canceltimer()	{  if(closetimer)	{  window.clearTimeout(closetimer);	closetimer = null;}}	$(document).ready(function()	{  $(\'#jsddm > li\').bind(\'mouseover\', jsddm_open)	$(\'#jsddm > li\').bind(\'mouseout\',  jsddm_timer)});	document.onclick = jsddm_close;	</script>	<style>	#jsddm {	margin: 0;	padding: 0;	z-index:100000;	}	#jsddm li {	float: left;	list-style: none;	font: 12px Tahoma, Arial;	z-index:100000;	}	#jsddm li a {	vertical-align:top;	display: block;	padding: 0;	text-decoration: none;	width: '.$width.';	color: black;	white-space: nowrap;	background: '.$alfa.';	border: 1px solid #FFFFFF;	z-index:100000;	}	#jsddm li a:hover {	border: 1px solid #000000;	background: '.$alfa.';	z-index:100000;	}	#jsddm li ul {	margin: 0;	padding: 0;	position: absolute;	visibility: hidden;	background: '.$color.';	z-index:100000;	}	#jsddm li ul li {	float: none;	display: inline;	z-index:100000;	}	#jsddm li ul li a {	width: '.$width.';	color:black;	}	</style>		<ul id="jsddm" align="left">			<li> <a href="#"><img src="'.$config ['site_url'].'images/admin/config-language.png" width="14"> '.$lang[9].'			<img src="'.$config ['site_url'].'images/admin/bottom.png" width="14" style="float:right;">			</a>				<ul>					'.$html_lang.'				</ul>			</li>		</ul>	';    return ($html_lang_select);}function option_lang_on (){    global $lang, $config;    $return_all_ok_lang = return_all_ok_lang();    if (count ($return_all_ok_lang)>0)    {        if (!isset ($html_lang))            $html_lang = '';        foreach ($return_all_ok_lang as $v)        {            $html_lang .= '<option value="'.$v['id'].'"> '.$v['name'].'</option>';        }        return ($html_lang);    } else {        return (0);    }}function return_one_translate ($id_elements, $id_lang, $type){    $sql = "SELECT * FROM ls_translate where type='$type' and id_lang='$id_lang' and id_elements='$id_elements';";    $result = mysql_query($sql);    $number = mysql_num_rows ($result);    if (!$number)    {        $sql = "SELECT * FROM ls_translate where type='$type' and id_elements='$id_elements';";        $result = mysql_query($sql);    }    return (mysql_fetch_array($result, MYSQL_ASSOC));}function return_all_items ($params=0, $sort=0, $limit, $limit_start='', $limit_count='', $price='') //Возвращаем все товары{    if ($sort==1)    {        if ($params)        {            $i = 0;            foreach ($params as $key => $v)            {                if ($params[$key][0]!=$params[$key-1][0])                {                    //$params_sql .= '(id_item IN (SELECT id_item FROM `ls_values_select` WHERE ';                    $params_sql .= 'JOIN (					SELECT id_item AS id_item_'.$key.'					FROM `ls_values_select` 					WHERE ';                    $tmp_key = $key;                }                $params_sql .= " `value`='".$v[1]."' ";                if (isset ($params[$key+1]) and $params[$key][0]==$params[$key+1][0])                {                    $params_sql .= ' or ';                }                if ($params[$key][0]!=$params[$key+1][0])                {                    $params_sql .= ')';                    $params_sql .= ' a'.$key.' ON id_item = id_item_'.$tmp_key.' ';                    unset ($tmp_key);                }            }            $sql = "SELECT `id_item` FROM `ls_values_select` a ".$params_sql." GROUP BY id_item;";            $results = mysql_query($sql);            $number = @mysql_num_rows ($results);            for ($i=0; $i<$number; $i++)            {                $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);            }            if ($number)            {                foreach ($array as $v)                {                    $array_new[] = $v['id_item'];                }                $array_new = array_unique($array_new);                //print_r ($array);                unset ($array);                foreach ($array_new as $v)                {                    $array[] = $v;                }                foreach ($array as $key => $v)                {                    $id_sql .= " `id` = '".$v."' ";                    if (isset ($array[$key+1]))                    {                        $id_sql .= ' or ';                    }                }            }            $sort = 1;        }    }    if ($sort==4)    {        $sql = "SELECT id_item FROM `ls_values_select` WHERE `value` = '".$params."';";        $results = mysql_query($sql);        $number = @mysql_num_rows ($results);        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        if ($number)        {            foreach ($array as $v)            {                $array_new[] = $v['id_item'];            }            $array_new = array_unique($array_new);            //print_r ($array);            unset ($array);            foreach ($array_new as $v)            {                $array[] = $v;            }            //$array = $array_new;            if (!isset ($id_sql))                $id_sql = '';            //print_r ($array);            foreach ($array as $key => $v)            {                $id_sql .= " `id` = '".$v."' ";                if (isset ($array[$key+1]))                {                    $id_sql .= ' or ';                }            }            $sort = 1;        }        //print $id_sql;    }    if ($sort==5)    {        $sql = "SELECT id_item FROM `ls_values_select` WHERE `value` = '".$params[0]."';";        $results = mysql_query($sql);        $number = @mysql_num_rows ($results);        for ($i=0; $i<$number; $i++)        {            $array_items[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        foreach ($params as $key => $v)        {            $id_sql .= " `id` = '".$v."' ";            if (isset ($params[$key+1]))            {                $id_sql .= ' or ';            }        }        foreach ($params as $key => $v)        {            if ($key!=0)            {                $info_filtr_param = mysql_fetch_array(mysql_query("SELECT `id_param`, `id_value_param` from `ls_filtr_param` where `id` = '".$v."';"));                /*$sql = "select `id` from `ls_cardparam` where `id_param` = '".$info_filtr_param['id_param']."' and `db_type` = 'select';";                $results = mysql_query($sql);                $number = @mysql_num_rows ($results);                if ($number>0)                {                    for ($i=0; $i<$number; $i++)                    {                        $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);                    }                }*/                $array_id_card_param_new[$key][0] = $info_filtr_param['id_param'];                $array_id_card_param_new[$key][1] = $info_filtr_param['id_value_param'];            }        }        $i = 0;        if (count($array_id_card_param_new))        {            foreach ($array_id_card_param_new as $key => $v)            {                if ($array_id_card_param_new[$key][0]!=$array_id_card_param_new[$key-1][0])                {                    $params_sql .= '(id_item IN (SELECT id_item FROM `ls_values_select` WHERE ';                }                $params_sql .= " `value`='".$v[1]."' ";                if (isset ($array_id_card_param_new[$key+1]) and $array_id_card_param_new[$key][0]==$array_id_card_param_new[$key+1][0])                {                    $params_sql .= ' or ';                }                if ($array_id_card_param_new[$key][0]!=$array_id_card_param_new[$key+1][0])                {                    $params_sql .= '))';                    if (isset ($array_id_card_param_new[$key+1]))                    {                        $params_sql .= ' and ';                    }                }            }        }        unset ($array);        $sql = "SELECT `id_item` FROM `ls_values_select` where ".$params_sql.";";        $results = mysql_query($sql);        $number = @mysql_num_rows ($results);        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        $price_array = explode ('|', $price);        $sql = "select `id_item` from `ls_values_prices` where `value` >= '".$price_array[1]."' and `value` <= '".$price_array[2]."';";        $results = mysql_query($sql);        $number_2 = @mysql_num_rows ($results);        if (count($params)>1 and $number==0)        {            return ($number);        }        if ($number==0 and $number_2==0)        {            return ($number);        }        for ($i=0; $i<$number_2; $i++)        {            $array_price[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        foreach ($array_price as $v)        {            $array_price_new[] = $v['id_item'];        }        foreach ($array_items as $v)        {            $array_items_new[] = $v['id_item'];        }        foreach ($array_price_new as $v)        {            if (in_array($v, $array_items_new))                $new_array[] = $v;        }        $array_price_new = $new_array;        unset ($new_array);        if (count($array))        {            foreach ($array as $v)            {                $array_new[] = $v['id_item'];            }        }        $array_new = @array_unique($array_new);        if ($number)        {            foreach ($array_new as $v)            {                if (in_array($v, $array_price_new))                {                    $new_array[] = $v;                }            }            $array_new = $new_array;        } else {            $number = 1;            $array_new = $array_price_new;        }        if ($number)        {            // print_r ($array_new);            unset ($array, $id_sql);            foreach ($array_new as $v)            {                $array[] = $v;            }            foreach ($array as $key => $v)            {                $id_sql .= " `id` = '".$v."' ";                if (isset ($array[$key+1]))                {                    $id_sql .= ' or ';                }            }            $sort = 1;        }    }    if ($sort==6)    {        foreach ($params as $key => $v)        {            $sql = "SELECT `id_item` FROM `ls_values_select` where `value` = '".$v."';";            $results = mysql_query($sql);            $number = @mysql_num_rows ($results);            for ($i=0; $i<$number; $i++)            {                $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);            }            foreach ($array as $v)            {                $tmp_array[] = $v['id_item'];            }            $new_array[$key][] = $tmp_array;            unset ($array, $tmp_array);        }        switch (count($new_array))        {            case 1:                $results = $new_array[0];                break;            case 2:                $results = array_intersect($new_array[1], $new_array[0]);                break;            case 3:                $results = array_intersect($new_array[2], $new_array[1], $new_array[0]);                break;            case 4:                $results = array_intersect($new_array[3], $new_array[2], $new_array[1], $new_array[0]);                break;        }        if (count($results))        {            foreach ($results[0] as $key => $v)            {                $id_sql .= '`id` = '.$v;                if (isset ($results[0][$key+1]))                {                    $id_sql .= ' or ';                }            }            $sort = 1;        } else {            return(0);        }    }    if ($sort==7)    {        foreach ($params as $key => $v)        {            $sql = "SELECT `id_item` FROM `ls_values_select` where `value` = '".$v."';";            $results = mysql_query($sql);            $number = @mysql_num_rows ($results);            for ($i=0; $i<$number; $i++)            {                $array[] = mysql_fetch_array($results, MYSQL_ASSOC);            }        }        if (count($array))        {            foreach ($array as $key => $v)            {                $id_sql .= '`id` = '.$v['id_item'];                if (isset ($array[$key+1]))                {                    $id_sql .= ' or ';                }            }            $sort = 1;        } else {            return(0);        }    }    switch ($sort)    {        case 0:            $sql = "SELECT * FROM `ls_items` order by id DESC LIMIT ".$limit_start.",".$limit_count.";";            $results = mysql_query($sql);            break;        case 1:            if (!strlen($id_sql))            {                return(0);            }            $sql = "SELECT * FROM `ls_items` where ".$id_sql." order by id DESC LIMIT ".$limit_start.",".$limit_count.";";            $results = mysql_query($sql);            break;        case 2:            $sql = "SELECT * FROM `ls_items` order by visit DESC ".$limit.";";            $results = mysql_query($sql);            break;        case 3:            $sql = "SELECT * FROM `ls_items` order by RAND() LIMIT ".$limit_start.",".$limit_count.";";            $results = mysql_query($sql);            break;    }    $number = @mysql_num_rows ($results);    unset ($array);    if ($number)    {        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        return ($array);    } else {        return (0);    }}function return_count_items ($params=0, $sort=0, $limit, $price='') //Возвращаем все товары{    if ($sort==1)    {        if ($params)        {            $i = 0;            foreach ($params as $key => $v)            {                if ($params[$key][0]!=$params[$key-1][0])                {                    //$params_sql .= '(id_item IN (SELECT id_item FROM `ls_values_select` WHERE ';                    $params_sql .= 'JOIN (					SELECT id_item AS id_item_'.$key.'					FROM `ls_values_select` 					WHERE ';                    $tmp_key = $key;                }                $params_sql .= " `value`='".$v[1]."' ";                if (isset ($params[$key+1]) and $params[$key][0]==$params[$key+1][0])                {                    $params_sql .= ' or ';                }                if ($params[$key][0]!=$params[$key+1][0])                {                    $params_sql .= ')';                    $params_sql .= ' a'.$key.' ON id_item = id_item_'.$tmp_key.' ';                    unset ($tmp_key);                }            }            $sql = "SELECT `id_item` FROM `ls_values_select` a ".$params_sql." GROUP BY id_item;";            $results = mysql_query($sql);            $number = @mysql_num_rows ($results);            for ($i=0; $i<$number; $i++)            {                $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);            }            if ($number)            {                foreach ($array as $v)                {                    $array_new[] = $v['id_item'];                }                $array_new = array_unique($array_new);                //print_r ($array);                unset ($array);                foreach ($array_new as $v)                {                    $array[] = $v;                }                foreach ($array as $key => $v)                {                    $id_sql .= " `id` = '".$v."' ";                    if (isset ($array[$key+1]))                    {                        $id_sql .= ' or ';                    }                }            }            $sort = 1;        }    }    if ($sort==4)    {        $sql = "SELECT id_item FROM `ls_values_select` WHERE `value` = '".$params."';";        $results = mysql_query($sql);        $number = @mysql_num_rows ($results);        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        if ($number)        {            foreach ($array as $v)            {                $array_new[] = $v['id_item'];            }            $array_new = array_unique($array_new);            //print_r ($array);            unset ($array);            foreach ($array_new as $v)            {                $array[] = $v;            }            if (!isset ($id_sql))                $id_sql = '';            foreach ($array as $key => $v)            {                $id_sql .= " `id` = '".$v."' ";                if (isset ($array[$key+1]))                {                    $id_sql .= ' or ';                }            }            $sort = 1;        }    }    if ($sort==5)    {        $sql = "SELECT id_item FROM `ls_values_select` WHERE `value` = '".$params[0]."';";        $results = mysql_query($sql);        $number = @mysql_num_rows ($results);        for ($i=0; $i<$number; $i++)        {            $array_items[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        foreach ($params as $key => $v)        {            $id_sql .= " `id` = '".$v."' ";            if (isset ($params[$key+1]))            {                $id_sql .= ' or ';            }        }        foreach ($params as $key => $v)        {            if ($key!=0)            {                $info_filtr_param = mysql_fetch_array(mysql_query("SELECT `id_param`, `id_value_param` from `ls_filtr_param` where `id` = '".$v."';"));                /*$sql = "select `id` from `ls_cardparam` where `id_param` = '".$info_filtr_param['id_param']."' and `db_type` = 'select';";                $results = mysql_query($sql);                $number = @mysql_num_rows ($results);                if ($number>0)                {                    for ($i=0; $i<$number; $i++)                    {                        $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);                    }                }*/                $array_id_card_param_new[$key][0] = $info_filtr_param['id_param'];                $array_id_card_param_new[$key][1] = $info_filtr_param['id_value_param'];            }        }        $i = 0;        if (count ($array_id_card_param_new))        {            foreach ($array_id_card_param_new as $key => $v)            {                if ($array_id_card_param_new[$key][0]!=$array_id_card_param_new[$key-1][0])                {                    $params_sql .= '(id_item IN (SELECT id_item FROM `ls_values_select` WHERE ';                }                $params_sql .= " `value`='".$v[1]."' ";                if (isset ($array_id_card_param_new[$key+1]) and $array_id_card_param_new[$key][0]==$array_id_card_param_new[$key+1][0])                {                    $params_sql .= ' or ';                }                if ($array_id_card_param_new[$key][0]!=$array_id_card_param_new[$key+1][0])                {                    $params_sql .= '))';                    if (isset ($array_id_card_param_new[$key+1]))                    {                        $params_sql .= ' and ';                    }                }            }        }        unset ($array);        $sql = "SELECT `id_item` FROM `ls_values_select` where ".$params_sql.";";        $results = mysql_query($sql);        $number = @mysql_num_rows ($results);        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        $price_array = explode ('|', $price);        $sql = "select `id_item` from `ls_values_prices` where `value` >= '".$price_array[1]."' and `value` <= '".$price_array[2]."';";        $results = mysql_query($sql);        $number_2 = @mysql_num_rows ($results);        if (count($params)>1 and $number==0)        {            return ($number);        }        if ($number==0 and $number_2==0)        {            return ($number);        }        for ($i=0; $i<$number_2; $i++)        {            $array_price[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        if (count($array_price))        {            foreach ($array_price as $v)            {                $array_price_new[] = $v['id_item'];            }        }        if(count($array_items))        {            foreach ($array_items as $v)            {                $array_items_new[] = $v['id_item'];            }        }        if (count($array_price_new))        {            foreach ($array_price_new as $v)            {                if (in_array($v, $array_items_new))                    $new_array[] = $v;            }        }        $array_price_new = $new_array;        unset ($new_array);        if (count($array))        {            foreach ($array as $v)            {                $array_new[] = $v['id_item'];            }        }        $array_new = @array_unique($array_new);        if ($number)        {            foreach ($array_new as $v)            {                if (in_array($v, $array_price_new))                {                    $new_array[] = $v;                }            }            $array_new = $new_array;        } else {            $number = 1;            $array_new = $array_price_new;        }        if ($number)        {            // print_r ($array_new);            unset ($array, $id_sql);            if (count($array_new))            {                foreach ($array_new as $v)                {                    $array[] = $v;                }            }            if (count($array))            {                foreach ($array as $key => $v)                {                    $id_sql .= " `id` = '".$v."' ";                    if (isset ($array[$key+1]))                    {                        $id_sql .= ' or ';                    }                }            }            $sort = 1;        }    }    if ($sort==7)    {        foreach ($params as $key => $v)        {            $sql = "SELECT `id_item` FROM `ls_values_select` where `value` = '".$v."';";            $results = mysql_query($sql);            $number = @mysql_num_rows ($results);            for ($i=0; $i<$number; $i++)            {                $array[] = mysql_fetch_array($results, MYSQL_ASSOC);            }        }        if (count($array))        {            foreach ($array as $key => $v)            {                $id_sql .= '`id` = '.$v['id_item'];                if (isset ($array[$key+1]))                {                    $id_sql .= ' or ';                }            }            $sort = 1;        } else {            return(0);        }    }    switch ($sort)    {        case 0:            $sql = "SELECT count(*) FROM `ls_items` order by id DESC;";            $results = mysql_query($sql);            break;        case 1:            if (!strlen($id_sql))            {                return(0);            }            $sql = "SELECT count(*) FROM `ls_items` where ".$id_sql." order by id DESC;";            $results = mysql_query($sql);            break;        case 2:            $sql = "SELECT count(*) FROM `ls_items` order by visit DESC ".$limit.";";            $results = mysql_query($sql);            break;    }    $array = mysql_fetch_array($results, MYSQL_ASSOC);    $count = $array['count(*)'];    return ($count);}function return_cardparam_id_for_id_card_id_param($id_card, $id_param, $db_type){    $sql = "SELECT `id` FROM `ls_cardparam` where `id_card` = '".$id_card."' and `id_param` = '".$id_param."' and `db_type` = '".$db_type."';";    $info_cardparam = mysql_fetch_array(mysql_query($sql), MYSQL_ASSOC);    return($info_cardparam['id']);}function return_item_id_card_info_ls_items($id){    $info_item = mysql_fetch_array(mysql_query("select `id_card` from ls_items where `id` = '".$id."';"), MYSQL_ASSOC);    return ($info_item['id_card']);}function return_param_for_card ($id_card){    $sql = "SELECT * FROM ls_cardparam where id_card='".$id_card."' order by position DESC;";    $results = mysql_query($sql);    $number = @mysql_num_rows ($results);    if ($number>0)    {        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        return ($array);    } else {        return(0);    }}function return_one_cardparam_for_id_card_and_idparam ($id_card, $id_param)//возвращаем одну связку карта товара - параметр{    $sql = "SELECT * FROM `ls_cardparam` where id_card='$id_card' and id_param='$id_param';";    $result = mysql_query($sql);    return (mysql_fetch_array($result, MYSQL_ASSOC));}function return_all_info_item ($id_item){}function go_sms ($to, $message){    global $config;    $request = 'http://alphasms.com.ua/api/http.php?version=http&login='.$config['user_params_1'].'&password='.$config['user_params_2'].'&command=send&from='.$config['user_params_3'].'&to='.$to.'&message='.str_replace (' ', '%20', $message);    file_get_contents ($request);}function getSmsPrice($to){    global $config;    $request = 'http://alphasms.com.ua/api/http.php?version=http&login='.$config['user_params_1'].'&password='.$config['user_params_2'].'&command=price&to='.$to;    $html = file_get_contents ($request);    $price = returnSubstrings($html, 'price:', 'currency');    return (trim($price[0]));}function send_sms($param){    switch ($param)    {        case 0:            global $config;            $config['user_params_4'] = str_replace (' ', '', $config['user_params_4']);            $array_number_phone = explode (',', $config['user_params_4']);            foreach ($array_number_phone as $v)            {                go_sms ($v, 'New order, '.date("d.m.Y H:i:s"));            }            break;        case 1:            global $config;            $config['user_params_4'] = str_replace (' ', '', $config['user_params_4']);            $array_number_phone = explode (',', $config['user_params_4']);            foreach ($array_number_phone as $v)            {                go_sms ($v, 'Заказ в один клик '.date("d.m.Y H:i:s"));            }            break;    }}function check_user(){    global $config;    if (isset ($_COOKIE['login']) and isset ($_COOKIE['password']))    {        $info_for_user = get_user_info_by_login($_COOKIE['login']);        if (count ($info_for_user)>1)        {            if ($info_for_user['accesslevel']==100)            {                if ($_COOKIE['login']==$info_for_user['login'] and $_COOKIE['password']==$info_for_user['password'])                {                    setcookie ("login", $info_for_user['login'], time() + $config['time_life_cookie']);                    setcookie ("password", $info_for_user['password'], time() + $config['time_life_cookie']);                    setcookie ("id_user_online", $info_for_user['id'], time() + $config['time_life_cookie']);                    mysql_query ("update ls_users set time_login='".time()."';");                    return(1);                } else {                    return ('Don\'T permission');                }            } else {                return ('Don\'T permission');            }        } else {            return ('Don\'T permission');        }    } else {        return ('Don\'T permission');    }}function translit($str){    $tr = array(        "А"=>"A","Б"=>"B","В"=>"V","Г"=>"G",        "Д"=>"D","Е"=>"E","Ж"=>"J","З"=>"Z","И"=>"I",        "Й"=>"Y","К"=>"K","Л"=>"L","М"=>"M","Н"=>"N",        "О"=>"O","П"=>"P","Р"=>"R","С"=>"S","Т"=>"T",        "У"=>"U","Ф"=>"F","Х"=>"H","Ц"=>"TS","Ч"=>"CH",        "Ш"=>"SH","Щ"=>"SCH","Ъ"=>"","Ы"=>"YI","Ь"=>"",        "Э"=>"E","Ю"=>"YU","Я"=>"YA","а"=>"a","б"=>"b",        "в"=>"v","г"=>"g","д"=>"d","е"=>"e","ж"=>"j",        "з"=>"z","и"=>"i","й"=>"y","к"=>"k","л"=>"l",        "м"=>"m","н"=>"n","о"=>"o","п"=>"p","р"=>"r",        "с"=>"s","т"=>"t","у"=>"u","ф"=>"f","х"=>"h",        "ц"=>"ts","ч"=>"ch","ш"=>"sh","щ"=>"sch","ъ"=>"y",        "ы"=>"yi","ь"=>"","э"=>"e","ю"=>"yu","я"=>"ya",        " " => "_", "і" => "i", "І" => "I", "ї" => "i",        "Ї" => "I", "є" => "e", "Є" => "e", "_" => "", '"' => ''    );    return strtr($str,$tr);}function generate_menu($id){    global $id_online_lang;    global $lang;    require_once ('admin/engine/menu/functions.php');    $info_menu = return_one_menu($id);    $true_values_select_params = return_all_select_values_params($info_menu['id_select_params']);    //print_r ($true_values_select_params);    if ($true_values_select_params)    {        //print count($true_values_select_params);        foreach ($true_values_select_params as $key => $v_value)        {            $info_translate = return_translate_for_id_elements_values_select ($v_value['id'], $id_online_lang);            //$html_option .= '<option value="'.$v_value['id'].'">'.$info_translate['text'].'</option>';            $info_menu_tmp = str_replace ('{id}', '_'.$v_value['id'], $info_menu['class_parent_link']);            if ($info_menu['use_parent'])            {                $father_link = (str_replace ('{link}', '<span id="my_test_'.$v_value['id'].'">'.$info_translate['text'].'</span>', $info_menu_tmp)); //отримали батьківське посилання з стильом                $podlink = return_all_select_values_params_by_parent_id($v_value['id']);                if ($podlink)                {                    if (!isset ($$blok_podlink))                        $blok_podlink = '';                    if (isset ($_GET['a']['select'][0]) and $_GET['a']['select'][0]==$v_value['id'])                        $class = ' id="active"';                    $blok_podlink .= str_replace ('{link}', '<a href="{main_sait}{lang}/shop/'.translit($info_translate['text']).'/?a[select][]='.$v_value['id'].'"'.$class.'>'.$lang[374].'</a>', $info_menu['class_link']);                    unset ($class);                    foreach ($podlink as $v)                    {                        $info_translate = return_translate_for_id_elements_values_select ($v['id'], $id_online_lang);                        if (isset ($_GET['a']['select'][0]) and $_GET['a']['select'][0]==$v['id'])                            $class = ' id="active"';                        $blok_podlink .= str_replace ('{link}', '<a href="{main_sait}{lang}/shop/'.translit($info_translate['text']).'/?a[select][]='.$v['id'].'"'.$class.'>'.$info_translate['text'].'</a>', $info_menu['class_link']);                        unset ($class);                    }                    $true_one_blok = (str_replace ('{block}', $blok_podlink, $info_menu['class_blok_link']));                }            } else {                //$father_link = (str_replace ('{link}', '<a href="" id="my_test_'.$v_value['id'].'">'.$info_translate['text'].'</a>', $info_menu_tmp));                if (isset ($_GET['a']['select'][0]) and $_GET['a']['select'][0]==$v_value['id'])                    $class = ' id="active"';                $father_link = str_replace ('{link}', '<a href="{main_sait}{lang}/shop/'.translit($info_translate['text']).'/?a[select][]='.$v_value['id'].'"'.$class.'>'.$info_translate['text'].'</a>', $info_menu_tmp);//отримали батьківське посилання з стильом                unset ($class);            }            if (!isset ($true_one_blok))                $true_one_blok = '';            $true_one_blok = $father_link."\n".$true_one_blok;            if (!isset ($return_block))                $return_block = '';            $return_block .= str_replace ('{block}', $true_one_blok, $info_menu['class_parent_blok']);            unset ($blok_podlink, $true_one_blok, $father_link, $podlink);        }        $return_block = str_replace ('{block}', $return_block, $info_menu['main_menu']);    }    if (isset ($return_block))    {        return(stripslashes($return_block));    } else {        return (0);    }}function send_message_for_email ($mail_to, $subject, $body_mail, $type_mail, $id_other = ''){    require_once ('lib/smtp.php');    require_once ('lib/sasl.php');    global $config;    $smtp=new smtp_class;    $from=$config['user_params_22'];  /* \u0430\u0434\u0440\u0435\u0441 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u044f */  $sender_line=__LINE__;    $to=$mail_to;  /* \u0430\u0434\u0440\u0435\u0441 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f */ $recipient_line=__LINE__;    $smtp->host_name=$config['user_params_24'];    /* smtp \u0441\u0435\u0440\u0432\u0435\u0440 \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c\u0441\u044f \u043f\u043e\u0447\u0442\u0430 */    $smtp->host_port=$config['user_params_25'];    /* \u043f\u043e\u0440\u0442 smtp \u0441\u0435\u0440\u0432\u0435\u0440\u0430 */    $smtp->ssl=$config['user_params_26'];    /* \u0431\u043e\u043b\u044c\u0448\u0430\u044f \u0447\u0430\u0441\u0442\u044c \u043e\u043f\u0446\u0438\u0439 \u0431\u044b\u043b\u0430 \u043e\u043f\u0438\u0441\u0430\u043d\u0430 \u0432\u044b\u0448\u0435 */    $smtp->start_tls=0;    $smtp->localhost="localhost";    $smtp->timeout=60;    $smtp->data_timeout=0;    $smtp->debug=0;    /* \u043f\u043e\u043b\u0435\u0437\u043d\u043e \u0434\u043b\u044f \u043e\u0442\u043b\u0430\u0434\u043a\u0438 - \u043b\u043e\u0433 \u043e\u0442\u0432\u0435\u0442\u043e\u0432 smtp \u0441\u0435\u0440\u0432\u0435\u0440\u0430 */    $smtp->html_debug=0;    /* \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0442\u0432\u0435\u0442 \u0432 HTML */    $smtp->pop3_auth_host=$config['user_params_24'];    /* \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0435 \u0441\u043b\u0443\u0436\u0431\u044b \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0432\u043c\u0435\u0441\u0442\u043e \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043d\u0430 smtp \u0441\u0435\u0440\u0432\u0435\u0440\u0435    \u0437\u0430\u043b\u043e\u0433\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043d\u0430 pop3 */    $smtp->user=$config['user_params_22'];    /* \u043b\u043e\u0433\u0438\u043d \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f */    $smtp->realm="mail.signalua.com";    /* \u0434\u043e\u043c\u0435\u043d \u043f\u043e\u0447\u0442\u043e\u0432\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 */    $smtp->password=$config['user_params_23'];    /* \u043f\u0430\u0440\u043e\u043b\u044c */    $smtp->workstation="";    /* \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f NTLM \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 */    $smtp->authentication_mechanism="";    /* \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043c\u0435\u0442\u043e\u0434 SASL \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438    (LOGIN, PLAIN, CRAM-MD5, NTLM \u0438 \u0442.\u0434.) ..     \u0435\u0441\u043b\u0438 \u043d\u0435 \u0437\u043d\u0430\u0435\u0442\u0435 - \u043e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u043f\u0443\u0441\u0442\u044b\u043c */    if($smtp->SendMessage(        $from,        array(            $to        ),        array(            "From: INFO@SOROKAVORONA.EU <$from>",            "To: $to",            "Content-type:text/html;charset=UTF8",            "Subject: ".$subject,            "Date: ".strftime("%a, %d %b %Y %H:%M:%S %Z")        ), $body_mail))    {        $sql = "	INSERT INTO `ls_mail_out` (`subject`, `to`, `body_mail`, `time`, `type_mail`, `id_other`) VALUES ('".$subject."', '".$to."', '".$body_mail."', CURRENT_TIMESTAMP, '".$type_mail."', '".$id_other."');	";        if (mysql_query($sql))        {            return(1);        } else {            return(2);        }    } else {        return(0);    }    $smtp->error."\n";}function generate_due($id_order){    global $config, $id_online_lang, $lang;    $sql = "SELECT * FROM `ls_orders` where `id` = '".$id_order."';";    $info_order = mysql_fetch_array (mysql_query($sql), MYSQL_ASSOC);    $sql = "select `id`, `id_item`, `other_param`, `time` from ls_cart where uniq_user='".$info_order['uniq_user']."' and status = '1';";    $results = mysql_query($sql);    $number = @mysql_num_rows ($results);    $item_template = return_one_template($config['user_params_27']);    $html_item = $item_template['template'];    if ($number>0)    {        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }    }    foreach ($array as $key => $v)    {        $html_item = $item_template['template'];        $sql = "select * from `ls_items` where `id` = '".$v['id_item']."';";        $results = mysql_query($sql);        $info_item_ls_item = mysql_fetch_array($results, MYSQL_ASSOC);        //print_r ($info_item_ls_item);        $array_text = returnSubstrings($html_item, '{text_', '}');        $array_price = returnSubstrings($html_item, '{price_', '}');        $array_select = returnSubstrings($html_item, '{select_', '}');        $array_template = returnSubstrings($html_item, '{template_', '}');        $info_item = return_item_info ($v['id_item'], $id_online_lang);        $html_item = str_replace ('{№}', $key+1, $html_item);        if (count($array_template))        {            foreach ($array_template as $v_template)            {                $a_template = explode ('_', $v_template);                if ($a_template[1]==$info_item_ls_item['id_card'])                {                    $add_template = return_one_template($a_template[0]);                    $add_template = $add_template['template'];                    $html_item = str_replace ('{template_'.$v_template.'}', $add_template, $html_item);                } else {                    $html_item = str_replace ('{template_'.$v_template.'}', '', $html_item);                }            }        }        if (count($array_text))        {            foreach ($array_text as $text_id)            {                $a_text = explode ('_', $text_id);                $text = $info_item['text'.$a_text[0]];                $text = $text['text'];                $html_item = str_replace ('{text_'.$text_id.'}', $text, $html_item);            }        }        if (count($array_price))        {            foreach ($array_price as $price_id)            {                $price = $info_item['price'.$price_id];                $price = $price['text'];                $array_price_new = explode ('|', $price);                $html_item = str_replace ('{price_'.$price_id.'}', $array_price_new[0], $html_item);                $html_item = str_replace ('{valuta}', $array_price_new[1], $html_item);                $allprice = $allprice + $array_price_new[0];                $valuta = $array_price_new[1];            }        }        if (count($array_select))        {            foreach ($array_select as $select_id)            {                $select = $info_item['select'.$select_id];                foreach ($select as $key => $v1)                {                    $html_select .= $v1['text'];                    if (isset ($select[$key+1]))                    {                        $html_select .= ',';                    }                }                $html_item = str_replace ('{select_'.$select_id.'}', $html_select, $html_item);                unset ($html_select);            }        }        $full_item_check .= $html_item;        unset ($html_item);    }    //print ($full_item_check);    $all_payment_offline = return_all_payment_template();    $allsuma = $allprice+$config['user_params_16'];    if ($info_order['discount'])    {        $discount = $lang[265].': '.$info_order['discount'].' '.$valuta.'. <br>';        $allsuma = $allsuma - $info_order['discount'];    }    if ($all_payment_offline)    {        foreach ($all_payment_offline as $v)        {            $info_offline_payment = mysql_fetch_array(mysql_query("SELECT `text` FROM `ls_translate` where `type` = 'pay_template' and `id_lang` = '".$id_online_lang."' and `id_elements` = '".$v['id']."';"), MYSQL_ASSOC);            $info_offline_payment_name = mysql_fetch_array(mysql_query("SELECT `text` FROM `ls_translate` where `type` = 'pay_name' and `id_lang` = '".$id_online_lang."' and `id_elements` = '".$v['id']."';"), MYSQL_ASSOC);            $info_offline_payment = $info_offline_payment['text'];            $info_offline_payment = str_replace ("{number_order}", $id_order, $info_offline_payment);            $info_offline_payment = str_replace ("{date}", date("d.m.Y", time()), $info_offline_payment);            $info_offline_payment = str_replace ("{date_order_actuality}", date("d.m.Y", time()), $info_offline_payment);            $payment_header = '	    <table border="0" width="100%" cellspacing="0" cellpadding="0">	    <tr>		<td style="border:1px solid black; background-color:#DBDBDB; text-align:center;">№</td>		<td style="border:1px solid black; background-color:#DBDBDB; text-align:center;">Назва</td>		<td style="border:1px solid black; background-color:#DBDBDB; text-align:center;">Од.</td>		<td style="border:1px solid black; background-color:#DBDBDB; text-align:center;">Кількість</td>		<td style="border:1px solid black; background-color:#DBDBDB; text-align:center;">Ціна</td>	    </tr>'.$full_item_check.'	    <tr>		<td colspan="5" style="text-align:right; font-weight:bold;">		'.$lang[227].' '.$allprice.' '.$valuta.'. <br>		'.$lang[228].' '.$config['user_params_16'].' '.$valuta.'. <br>		'.$discount.'		'.$lang[229].' '.$allsuma.' '.$valuta.'. <br>		</td>	    </tr>	    </table>	    	    ';            $info_offline_payment = str_replace ('{orders}', $payment_header, $info_offline_payment);            $info_offline_payment = str_replace ('{buyer}', $info_order['pib'], $info_offline_payment);            $info_offline_payment = '	    <div style="font-weight:bold; text-align:left;">'.$info_offline_payment_name['text'].'</div>	    <table border="0" style="border:1px solid black;">	    <tr>		<td>'.$info_offline_payment.'</td>	    </tr>	    </table><br>	    ';            $all_offline_payment .= $info_offline_payment;        }        $all_payment_offline = '	<div style="font-size:18px;">'.$lang[485].'</div>	'.$all_payment_offline.'	';        return ($all_offline_payment);    } else {        return(0);    }}function return_all_payment_template(){    $sql = "select * from `ls_payment` where `active` = 1;";    $results = mysql_query($sql);    $number = @mysql_num_rows ($results);    if ($number>0)    {        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        return ($array);    } else {        return(0);    }}function return_all_param_ligament_for_id_item_and_param ($id_item, $param){    $sql = "select * from `ls_values_ligament_price_param` where `id_item` = '".$id_item."' and `id_param_value` = '".$param."';";    $results = mysql_query($sql);    $number = @mysql_num_rows ($results);    if ($number>0)    {        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        return ($array);    } else {        return(0);    }}function return_price_for_param($id_item, $array_param){    $array_1 = return_all_param_ligament_for_id_item_and_param ($id_item, $array_param[0]);    $array_2 = return_all_param_ligament_for_id_item_and_param ($id_item, $array_param[1]);    $array_3 = return_all_param_ligament_for_id_item_and_param ($id_item, $array_param[2]);    if ($array_1)    {        foreach ($array_1 as $key => $v)        {            if ($array_2)            {                foreach ($array_2 as $key_2 => $v_2)                {                    if ($array_3)                    {                        foreach ($array_3 as $key_3 => $v_3)                        {                            if ($v['id_ligament']==$v_2['id_ligament'] and $v['id_ligament']==$v_3['id_ligament'] and $v_2['id_ligament']==$v_3['id_ligament'])                            {                                $id_ligament = $v_3['id_ligament'];                                $price = mysql_fetch_array(mysql_query("SELECT `price`, `id_reference_value` FROM `ls_values_ligament_price` where `id` = '".$id_ligament."';"), MYSQL_ASSOC);                                $array[0] = $price['price'];                                $array[1] = $price['id_reference_value'];                                $array[2] = $id_ligament;                                //print_r ($array_param);                                //print_r ($array);                                return ($array);                            }                        }                    }                }            }        }    }}function getMainImage ($idItem, $limit = 0){    $infoImage = mysql_fetch_array(mysql_query("SELECT `value` FROM `ls_values_image` where `id_item` = '".intval($idItem)."' order by `position` LIMIT ".$limit.",1;"), MYSQL_ASSOC);    return($infoImage['value']);}function getTwoImage ($idItem){    $infoImage = mysql_fetch_array(mysql_query("SELECT `value` FROM `ls_values_image` where `id_item` = '".intval($idItem)."' order by `position` DESC LIMIT 1,2;"), MYSQL_ASSOC);    return($infoImage['value']);}function generateItemLink ($idItem){//    $infoItem = mysql_fetch_array(mysql_query("SELECT * FROM `ls_items` where `id` = '".$idItem."';"), MYSQL_ASSOC);    global $config,$alt_name_online_lang;    $url = '{main_sait}{lang}/mode/item-'.intval($idItem).'.html';    $url = str_replace ('{main_sait}', $config['site_url'], $url);    $url = str_replace ('{lang}', $alt_name_online_lang, $url);    return($url);}//function getAllItemsWithParam($param)//{//    $select = $param['select'];//    $text = $param['text'];//    $price = $param['price'];//    if ($select)//    {//        foreach ($select as $key => $v)//        {//            $arraySelectSql = "`select_".$key."` = '".$v."'";//        }//        if (is_array($arraySelectSql))//        {//            $selectSql = implode (',', $arraySelectSql);//        } else {//            $selectSql = $arraySelectSql;//        }//    }//    $sql = "SELECT * FROM `ls_items` where ".$selectSql.";";//    $results = mysql_query($sql);//    $number = @mysql_num_rows ($results);//    if ($number>0)//    {//        for ($i=0; $i<$number; $i++)//        {//            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);//        }//        return ($array);//    } else {//        return (0);//    }//}function getCountAllItemsWithParam($param, $idCategory = 0){    $select = $param['select'];    if ($select)    {        foreach ($select as $key => $v)        {            foreach ($v as $v1)            {                $arraySql[$key][] = "(`select_".$key."` = '".$v1."' or `select_".$key."` LIKE '%\"".$v1."\"%')";                //if ($key==6 or $key==7)                //$noLimit = 1;            }        }        foreach ($arraySql as $key => $v)        {            $array[] = implode(' or ', $v);        }        foreach ($array as $key => $v)        {            $sql .= '('.$v.')';            if (isset ($array[$key+1]))            {                $sql .= ' and ';            }        }        $sql = 'SELECT COUNT(*) FROM `ls_items` where (`select_1` <> \'\' or `select_10` <> \'\' or `select_11` <> \'\' or `select_12` <> \'\' or `select_15` <> \'\' or `select_18` <> \'\') and '.$sql;        $infoCount = mysql_fetch_array(mysql_query($sql), MYSQL_ASSOC);//	if ($idCategory==0 or $noLimit==1)//	{//	    $infoCountAll = mysql_fetch_array(mysql_query("SELECT COUNT(*) FROM `ls_items`"), MYSQL_ASSOC);//	} else {//	    $infoCountAll = mysql_fetch_array(mysql_query("SELECT COUNT(*) FROM `ls_items` where ((`select_6` = '".$idCategory."' or `select_6` LIKE '%\"".$idCategory."\"%') or (`select_7` = '".$idCategory."' or `select_7` LIKE '%\"".$idCategory."\"%'))"), MYSQL_ASSOC);//	}        print 'Выбрано '.$infoCount['COUNT(*)'];        if ($infoCount['COUNT(*)'])            print ' <div class="linkView" onclick="viewItems();">Показать</div>';        print '<div style="float:right; cursor: pointer; margin-right: -12px;" onclick="closeFixedBlock();">[X]</div>';    }}function getCountAllItemsInProduction($param, $idCategory = 0){    $select = $param['select'];    if ($select)    {        foreach ($select as $key => $v)        {            foreach ($v as $v1)            {                $arraySql[$key][] = "(`select_".$key."` = '".$v1."' or `select_".$key."` LIKE '%\"".$v1."\"%')";                //if ($key==6 or $key==7)                //$noLimit = 1;            }        }        foreach ($arraySql as $key => $v)        {            $array[] = implode(' or ', $v);        }        foreach ($array as $key => $v)        {            $sql .= '('.$v.')';            if (isset ($array[$key+1]))            {                $sql .= ' and ';            }        }        $sql = 'SELECT COUNT(*) FROM `ls_items` where `select_3` = '.$idCategory.' and ('.$sql.')';        $infoCount = mysql_fetch_array(mysql_query($sql), MYSQL_ASSOC);        return ($infoCount['COUNT(*)']);    }}function getAllItemsWithParam($param, $limit = 0, $orderType = '', $typeSort = 1){//    $actions = 0;//    if (isset($param['select']['actions'])){//        $actions = 1;//        unset($param['select']['actions']);//    }    $select = $param['select'];//    print_r ($select);    if ($select ANd !empty($select))    {//        if ($actions==1){//            $sql = " `price_2` <> 0 and `text_3` = '' and `select_15` = 12 ";//        }        ksort($select);        $addGroup = '';        foreach ($select as $key => $v)        {            foreach ($v as $v1)            {                if ($key==2){                    if ($arrayChild = getArray("SELECT * FROM `ls_params_select_values` WHERE `parent_param_id` = '".$v1."' and `id_params` = 2")){                        $arrayToChildId = Array();                        foreach ($arrayChild as $oneChild){                            $arrayToChildId[] = mysql_real_escape_string($oneChild['id']);                        }                        $dopSqlChild = " OR `select_2` IN (".implode(',', $arrayToChildId).")";                    }                    $arraySql[$key][] = "(`select_".$key."` = '".mysql_real_escape_string($v1)."' or `select_".$key."` LIKE '%\"".mysql_real_escape_string($v1)."\"%' ".$dopSqlChild.")";                } else {                    $arraySql[$key][] = "(`select_".$key."` = '".mysql_real_escape_string($v1)."' or `select_".$key."` LIKE '%\"".mysql_real_escape_string($v1)."\"%')";                }                if ($v1==560 or $v1==553 or $v1 == 257){//                    $addGroup = " GROUP by `text_12`";                }                $addGroup = " GROUP by `text_1`,`select_2`";//                if ($key==13 and isset ($select[2])){//                    //TODO IN//                    $arraySql[$key][] = "(`select_".$key."` = '".$v1."' or `select_".$key."` LIKE '%\"".$v1."\"%' or `select_2` = '".$select[2][0]."' ".$dopSqlChild.")";////                    $arraySql[$key][] = "(`select_".$key."` = '".$v1."' or `select_".$key."` LIKE '%\"".$v1."\"%' or `select_2` = '".$select[2][0]."' or `select_2` LIKE '%\"".$select[2][0]."\"%'".$dopSqlChild.")";//                } else {//                    $arraySql[$key][] = "(`select_".$key."` = '".$v1."' or `select_".$key."` LIKE '%\"".$v1."\"%'".$dopSqlChild.")";//                }            }        }        foreach ($arraySql as $key => $v)        {            $array[] = implode(' or ', $v);        }        foreach ($array as $key => $v)        {            $sql .= '('.$v.')';            if (isset ($array[$key+1]))            {                $sql .= ' and ';            }        }        if (isset ($limit) and $limit != 0)        {            $limit = ' LIMIT '.$limit.', 32';        } else {            $limit  = ' LIMIT 0, 32';        }        if (strlen($orderType)==0)        {            $order = ' order by `inStock` DESC, `id`';        } else {            switch ($orderType)            {                case "price":                    $order = ' order by `inStock` DESC, `price_1`' ;                    break;                case "popular":                    $order = ' order by `inStock` DESC, `visit`';                    break;                case "name":                    $order = ' order by `inStock` DESC, `text_1`';                    break;                case "date":                    $order = ' order by `inStock` DESC,  `id`';                    if ($typeSort==1){                        $typeSort = 0;                    } else {                        $typeSort = 1;                    }                    break;            }        }        switch ($typeSort)        {            case 0:                $typeSortSql = '  ASC';                break;            case 1:                $typeSortSql = ' DESC ';                break;        }        $sql .= ' AND `inStock` = 1';        //SELECT * FROM `ls_items` where ((`select_5` = '77' or `select_5` LIKE '%"77"%')) AND `inStock` = 1 GROUP by `text_1`,`select_2` order by `inStock` DESC, `id` ASC LIMIT 0, 33        $emptySql = 'SELECT * FROM `ls_items` where  '.$sql.$addGroup;        $countSql = 'SELECT * FROM `ls_items` where  '.$sql.$addGroup;        $sql = 'SELECT * FROM `ls_items` where  '.$sql.$addGroup.$order.$typeSortSql.$limit;        $results = mysql_query($sql);        $number = @mysql_num_rows ($results);        if ($number>0)        {            for ($i=0; $i<$number; $i++)            {                $arrayItems[$i] = mysql_fetch_array($results, MYSQL_ASSOC);            }            $arrayOut['data'] = $arrayItems;            $arrayOut['sql'] = $emptySql;            $arrayOut['countSql'] = $countSql;            return ($arrayOut);        } else {            return (0);        }    } else {        if (isset ($limit) and $limit != 0)        {            $limit = ' LIMIT '.$limit.', 33';        } else {            $limit  = ' LIMIT 0, 33';        }        $addGroup = " GROUP by `text_1`,`select_2`";        $emptySql = 'SELECT * FROM `ls_items` '.$addGroup;        $countSql = 'SELECT * FROM `ls_items`  ';        $sql = 'SELECT * FROM `ls_items`  '.$addGroup.$order.$typeSortSql.$limit;        $results = mysql_query($sql);        $number = @mysql_num_rows ($results);        if ($number>0)        {            for ($i=0; $i<$number; $i++)            {                $arrayItems[$i] = mysql_fetch_array($results, MYSQL_ASSOC);            }            $arrayOut['data'] = $arrayItems;            $arrayOut['sql'] = $emptySql;            $arrayOut['countSql'] = $countSql;            return ($arrayOut);        } else {            return (0);        }    }}function getAllItemsWithParamSEARCH($param, $limit = 0, $orderType = '', $typeSort = 1){//    $sql = "LOWER(`text_1`) LIKE '%".strtolower($param)."%' or LOWER(`text_2`) LIKE '%".strtolower($param)."%' or LOWER(`text_3`) LIKE '%".strtolower($param)."%' or LOWER(`text_4`) LIKE '%".strtolower($param)."%'";    $sql = "(            `text_1` LIKE '%".mysql_real_escape_string(strtolower($param))."%'        or            `text_2` LIKE '%".mysql_real_escape_string(strtolower($param))."%'        or            `text_4` LIKE '%".mysql_real_escape_string(strtolower($param))."%'        or            `searchField` LIKE '%".mysql_real_escape_string(strtolower($param))."%')        AND `select_5` != 78        ";    if (isset ($limit) and $limit != 0)    {        $limit = ' LIMIT '.$limit.', 33';    } else {        $limit  = ' LIMIT 0, 33';    }    if (strlen($orderType)==0)    {        $order = ' order by `select_10`, `price_2`';    } else {        switch ($orderType)        {            case "price":                $order = ' order by `select_10`, `price_1`' ;                break;            case "popular":                $order = ' order by `select_10`, `visit`';                break;            case "name":                $order = ' order by `select_10`, `text_1`';                break;            case "date":                $order = ' order by `select_10`, `id`';                if ($typeSort==1){                    $typeSort = 0;                } else {                    $typeSort = 1;                }                break;        }    }    switch ($typeSort)    {        case 0:            $typeSortSql = ' DESC ';            break;        case 1:            $typeSortSql = ' ASC ';            break;    }    $sql = 'SELECT * FROM `ls_items` where ('.$sql.') GROUP by `text_1`,`select_2` '.$order.$typeSortSql.$limit;    $results = mysql_query($sql);    $number = @mysql_num_rows ($results);    if ($number>0)    {        for ($i=0; $i<$number; $i++)        {            $arrayItems[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        return ($arrayItems);    } else {        return (0);    }}function getNumberAllItemsWithParam($param){    $select = $param['select'];    ksort($select);    if ($select)    {        foreach ($select as $key => $v)        {            foreach ($v as $v1)            {                if ($key==2){                    if ($arrayChild = getArray("SELECT * FROM `ls_params_select_values` WHERE `parent_param_id` = '".$v1."' and `id_params` = 2")){                        $arrayToChildId = Array();                        foreach ($arrayChild as $oneChild){                            $arrayToChildId[] = mysql_real_escape_string($oneChild['id']);                        }                        $dopSqlChild = " OR `select_2` IN (".implode(',', $arrayToChildId).")";                    }                }                if ($key==13 and isset ($select[2])){                    //TODO IN                    $arraySql[$key][] = "(`select_".$key."` = '".mysql_real_escape_string($v1)."' or `select_".$key."` LIKE '%\"".mysql_real_escape_string($v1)."\"%' or `select_2` = '".mysql_real_escape_string($select[2][0])."' or `select_2` LIKE '%\"".mysql_real_escape_string($select[2][0])."\"%'".$dopSqlChild.")";                } else {                    $arraySql[$key][] = "(`select_".$key."` = '".mysql_real_escape_string($v1)."' or `select_".$key."` LIKE '%\"".mysql_real_escape_string($v1)."\"%'".$dopSqlChild.")";                }            }        }        foreach ($arraySql as $key => $v)        {            $array[] = implode(' or ', $v);        }        foreach ($array as $key => $v)        {            $sql .= '('.mysql_real_escape_string($v).')';            if (isset ($array[$key+1]))            {                $sql .= ' and ';            }        }        $sql = 'SELECT COUNT(*) FROM `ls_items` where '.$sql.' GROUP by `text_1`, `select_2`';        $count = mysql_fetch_array(mysql_query($sql), MYSQL_ASSOC);        return ($count['COUNT(*)']);    }}function getNumberAllItemsWithParamSEARCH($param){//    $sql = "LOWER(`text_1`) LIKE '%".strtolower($param)."%' or LOWER(`text_2`) LIKE '%".strtolower($param)."%' or LOWER(`text_3`) LIKE '%".strtolower($param)."%' or LOWER(`text_4`) LIKE '%".strtolower($param)."%'";    $sql = "(            `text_1` LIKE '%".mysql_real_escape_string(strtolower($param))."%'        or            `text_2` LIKE '%".mysql_real_escape_string(strtolower($param))."%'        or            `text_4` LIKE '%".mysql_real_escape_string(strtolower($param))."%'        or            `searchField` LIKE '%".mysql_real_escape_string(strtolower($param))."%')        AND `select_5` != 78 GROUP by `text_1`, `select_2`            ";    //$sql = "`text_1` LIKE '%".$param."%' or `text_2` LIKE '%".$param."%' or `text_3` LIKE '%".$param."%' or `text_4` LIKE '%".$param."%'";    $sql = 'SELECT COUNT(*) FROM `ls_items` where ('.$sql.')';    $count = mysql_fetch_array(mysql_query($sql), MYSQL_ASSOC);    return ($count['COUNT(*)']);}function getValuesSelectParamNotEmpty ($id, $typeSort=0){    if ($typeSort!='0'){        if ($typeSort=='name'){            $sort = " order by `ls_translate`.`text`";        } elseif ($typeSort=='position') {            $sort = " order by `ls_params_select_values`.`position`";        }    } else {        $sort = " order by `ls_translate`.`text`";    }    $sql = "SELECT         DISTINCT         `ls_params_select_values`.`id`,         `ls_params_select_values`.`text` as `info`,        `ls_translate`.`text`, `ls_params_select_values`.`position`,        `ls_params_select_values`.`parent_param_id`         FROM         `ls_params_select_values`         JOIN `ls_translate` ON `ls_translate`.`id_elements` = `ls_params_select_values`.`id`        JOIN        `ls_items` ON `ls_items`.`select_".$id."` = `ls_params_select_values`.`id`         WHERE (`ls_items`.`select_5` = 76 OR `ls_items`.`select_5` = 77) AND `ls_params_select_values`.`visible` = 1 AND `ls_params_select_values`.`id_params` = ".$id." and `ls_translate`.`type` = 'select_value' and `ls_translate`.`id_lang` = '".LANG."' ".$sort." ;";    $results = mysql_query($sql);    $number = @mysql_num_rows ($results);    if ($number>0)    {        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        return($array);    } else {        return (0);    }}function getValuesSelectParam ($id, $typeSort=0){    if ($typeSort!='0'){        if ($typeSort=='name'){            $sort = " order by `ls_translate`.`text`";        } elseif ($typeSort=='position') {            $sort = " order by `ls_params_select_values`.`position`";        }    } else {        $sort = " order by `ls_translate`.`text`";    }    $sql = "SELECT DISTINCT `ls_params_select_values`.`id`, `ls_params_select_values`.`text` as `info`, `ls_translate`.`text`, `ls_params_select_values`.`position`, `ls_params_select_values`.`parent_param_id` FROM `ls_params_select_values` JOIN `ls_translate` ON `ls_translate`.`id_elements` = `ls_params_select_values`.`id` WHERE `ls_params_select_values`.`visible` = 1 AND `ls_params_select_values`.`id_params` = ".$id." and `ls_translate`.`type` = 'select_value' and `ls_translate`.`id_lang` = '".LANG."' ".$sort." ;";    $results = mysql_query($sql);    $number = @mysql_num_rows ($results);    if ($number>0)    {        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        return($array);    } else {        return (0);    }}function getValuesSelectParamWithParent ($id, $idParent, $typeSort=0){    if ($typeSort!='0'){        if ($typeSort=='name'){            $sort = " order by `ls_translate`.`text`";        } elseif ($typeSort=='position') {            $sort = " order by `ls_params_select_values`.`position`";        }    } else {        $sort = " order by `ls_translate`.`text`";    }    $sql = "SELECT DISTINCT `ls_params_select_values`.`id`, `ls_translate`.`text`, `ls_params_select_values`.`text` as `valueText` FROM `ls_params_select_values` JOIN `ls_translate` ON `ls_translate`.`id` = `ls_params_select_values`.`id_translate` WHERE `ls_params_select_values`.`id_params` = ".$id." and `ls_translate`.`id_lang` = '".IDLANG."' and `ls_params_select_values`.`parent_param_id` = ".$idParent.$sort;    $results = mysql_query($sql);    $number = @mysql_num_rows ($results);    if ($number>0)    {        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        return($array);    } else {        return (0);    }}function getAllPhotoItem($id){    $sql = "SELECT `id`, `value` FROM `ls_values_image` where `id_item` = '".intval($id)."' order by `position`;";    $results = mysql_query($sql);    $number = @mysql_num_rows ($results);    if ($number>0)    {        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        return($array);    } else {        return (0);    }}function getAllSimilarItem($text){    $sql = "SELECT * FROM `ls_items` where `text_1` = '".mysql_real_escape_string($text)."' and (`select_1` <> '' or `select_10` <> '' or `select_11` <> '' or `select_12` <> '' or `select_15` <> '' or `select_18` <> '');";    $results = mysql_query($sql);    $number = @mysql_num_rows ($results);    if ($number>0)    {        for ($i=0; $i<$number; $i++)        {            $array[$i] = mysql_fetch_array($results, MYSQL_ASSOC);        }        return($array);    } else {        return (0);    }}function getOneReview($v, $ans = 0){    global $infoUser;    $answer = '';    if ($infoUser['accesslevel']==100 and $ans == 0){        $answer = '        <div class="row" style="margin: 3px 0px;">            <div class="col-lg-12" style="text-align: right;"><button class="btn btn-success btn-sm" onclick="$(\'#answerHtml_'.$v['id'].'\').toggle(300);">ответить</button></div>        </div>        <div class="row" style="display: none; margin: 5px 0px;" id="answerHtml_'.$v['id'].'">            <div class="col-lg-12">                <textarea id="answer_'.$v['id'].'" style="width: 100%; height: 50px;" class="form-control"></textarea>                <div style="margin-top: 5px;"><button class="btn btn-success" onclick="sendAnswer('.$v['id'].', '.$v['idItem'].');">Отправить</button></div>            </div>        </div>        ';    }    if ($ans==0){        if ($arrayReview = getArray("SELECT * FROM `ls_reviews` WHERE `idItem` = '".$v['idItem']."' and `idQuestion` = '".$v['id']."' order by `id` DESC;")){            foreach ($arrayReview as $answerOne){                $answer .= getOneReview($answerOne, 1);            }        }    }    if ($infoUser['accesslevel']==100){        $remove = '<a href="#" onclick="removeReview('.$v['id'].'); return false;">[x]</a>';    }    return ('    <li  id="review_'.$v['id'].'">       <div class="comments-box d-flex">          <div class="comments-text">             <div class="comments-top d-sm-flex align-items-start justify-content-between mb-5">                <div class="avatar-name">                   <b>'.$v['name'].'</b>'.$remove.'                   <div class="comments-date mb-20">                      <span>'.date('d.m.Y', $v['time']).'</span>                   </div>                </div>                <div class="user-rating">                   <ul>                    '.(($v['idQuestion']==0) ? getStarHtml($v['rating']) : '').'                   </ul>                </div>             </div>             <p class="m-0">'.$v['body'].'</p>             '.$answer.'          </div>       </div>    </li>    ');}function getStarHtml($rating){    switch ($rating){        case 0:            return ('без оцінки');            break;        case 1:            return ('                    <li><i class="fas fa-star"></i></li>                     ');            break;        case 2:            return ('<div class="small-ratings">                     <i class="fas fa-star rating-color"></i>                     <i class="fas fa-star rating-color"></i>                     </div>');            break;        case 3:            return ('<div class="small-ratings">                     <i class="fas fa-star rating-color"></i>                     <i class="fas fa-star rating-color"></i>                     <i class="fas fa-star rating-color"></i>                     </div>');            break;        case 4:            return ('<div class="small-ratings">                     <i class="fas fa-star rating-color"></i>                     <i class="fas fa-star rating-color"></i>                     <i class="fas fa-star rating-color"></i>                     <i class="fas fa-star rating-color"></i>                     </div>');            break;        case 5:            return ('<div class="small-ratings">                     <i class="fas fa-star rating-color"></i>                     <i class="fas fa-star rating-color"></i>                     <i class="fas fa-star rating-color"></i>                     <i class="fas fa-star rating-color"></i>                     <i class="fas fa-star  rating-color"></i>                     </div>');            break;    }}function getPriceArray($v){    $arrayPrice = Array();    if ($v['price_2']!=0 and $v['price_1']!=$v['price_2']){        $arrayPrice['price'] = $v['price_2'];        $arrayPrice['price_old'] = $v['price_1'];    } else {        $arrayPrice['price'] = $v['price_1'];    }    return ($arrayPrice);}function getPrice($price, $zakup = 0){    $price = $price*1.03;    if ($zakup==1)        return ($price);    if ($price<10){        return (ceil($price*3));    } elseif($price<50) {        return (ceil($price*1.5));    } elseif($price<100){        return (ceil($price*1.45));    } elseif($price<150){        return (ceil($price*1.3));    } elseif($price<200){        return(ceil($price*1.22));    } elseif ($price<300){        return (ceil($price*1.19));    } elseif($price<400){        return (ceil($price*1.16));    } elseif($price<500){        return (ceil($price*1.12));    } elseif($price<600){        return(ceil($price*1.1));    } else {        return(ceil($price*1.08));    }}function getItemLink($item){    global $config;    return ($config['site_url'].'ru/mode/item-'.$item['id'].'.html');}function getChildCategory($id, $arrayCategory = array()){    if (!in_array($id, $arrayCategory))        $arrayCategory[] = $id;    if ($infoCategory = getArray("SELECT * FROM `ls_params_select_values` WHERE `parent_param_id` = '".$id."';")){        foreach ($infoCategory as $v){            if (!in_array($id, $arrayCategory))                $arrayCategory[] = $v['id'];            $arrayCategory = getChildCategory($v['id'], $arrayCategory);        }        return ($arrayCategory);    } else {        if (!in_array($id, $arrayCategory))            $arrayCategory[] = $id;        return ($arrayCategory);    }}function getBreadcrumbFromCategory($id, $breadcrumbArray = '', $start = 0, $notActive = 0){    global $config;    $info = getOneValue($id);    if ($start==0){        if ($notActive==0){//            $breadcrumbArray[] = '<li class="active">'.$info['text'].'</li>';            if (strlen($info['text'])>0)                $breadcrumbArray[] = '<li><a href="'.$config['site_url'].'ru/shop/'.translit($info['text']).'/'.$info['id'].'">'.$info['text'].'</a></li>';        } else {            $breadcrumbArray[] = '<li><a href="'.$config['site_url'].'ru/shop/'.translit($info['text']).'/'.$info['id'].'">'.$info['text'].'</a></li>';        }    }    if ($info['parent_param_id']==0){        if (!$start==0){            if ($info['id']){                $breadcrumbArray[] = '<li><a href="'.$config['site_url'].'ru/shop/'.translit($info['text']).'/'.$info['id'].'">'.$info['text'].'</a></li>';            }        }        if ($id==0 and $start==0){//            $breadcrumbArray[] = '<li class="active">Каталог товаров</li>';            $breadcrumbArray[] = '<li><a href="'.$config['site_url'].'ru/shop/">Каталог товаров</a></li>';        } else {            $breadcrumbArray[] = '<li><a href="'.$config['site_url'].'ru/shop/">Каталог товаров</a></li>';        }        $breadcrumbArray[] = '<li><a href="'.$config['site_url'].'">PICASE.COM.UA</a></li>';        return (array_reverse($breadcrumbArray));    } else {        $start = 1;        $info = getOneValue($info['parent_param_id']);        $breadcrumbArray[] = '<li><a href="'.$config['site_url'].'ru/shop/'.translit($info['text']).'/'.$info['id'].'">'.$info['text'].'</a></li>';        return (getBreadcrumbFromCategory($info['parent_param_id'], $breadcrumbArray, $start));    }}function getRegion($userRegion = 0){    $optionRegion = '<option value="0">Сделайте выбор области</option>';    if ($arrayRegion = getArray("SELECT * FROM `ls_region` ORDER by `name`")){        foreach ($arrayRegion as $v){            if ($userRegion!=0 and $userRegion==$v['id']){                $optionRegion .= '<option value="'.$v['id'].'" selected>'.$v['name'].'</option>';            } else {                $optionRegion .= '<option value="'.$v['id'].'">'.$v['name'].'</option>';            }        }    }    return ($optionRegion);}function getCity($idRegion, $userCity = 0){    $optionRegion = '<option value="0">Сделайте выбор города</option>';    if ($arrayRegion = getArray("SELECT * FROM `ls_cities` where `regionId` = '".$idRegion."' ORDER by `name`")){        foreach ($arrayRegion as $v){            if ($userCity!=0 and $userCity==$v['id']){                $optionRegion .= '<option value="'.$v['id'].'" selected>'.$v['name'].'</option>';            } else {                $optionRegion .= '<option value="'.$v['id'].'">'.$v['name'].'</option>';            }        }    }    return ($optionRegion);}function sms_new_order($phone, $idOrder = '', $notCallBack = 0){    //Якщо день з понеділка по п'ятницю    global $config;    $arrayDate = explode(',', $config['user_params_44']);    $arrayDateTrueFormat = Array();    if (!empty($arrayDate)){        foreach ($arrayDate as $v){            $arrayDateTrueFormat[] = date('d-m-Y', strtotime($v));        }    }    if (!empty($idOrder)){        $idOrderText = $idOrder;//        $idOrderText = '';    }    if (!empty($arrayDateTrueFormat) and in_array(date('d-m-Y'), $arrayDateTrueFormat)){        go_sms($phone, $config['user_params_45'].$idOrderText);    } else {        //Якщо день з понеділка по п'ятницю        if (date('w')>=1 and date('w')<5){            //Якщо година з 10 до 18 включно            if ($notCallBack==0){                if (date('G')>=10 and date('G')<=18){                    //Дякуємо! Замовлення №46707 прийнято, з Вами зв'яжеться наш менеджер.                    go_sms($phone, 'Дякуємо! Замовлення №'.$idOrderText.' прийнято, з Вами зв\'яжеться наш менеджер');                } else {                    go_sms($phone, 'Дякуємо! Замовлення №'.$idOrderText.' прийнято, після 10-00 з Вами зв\'яжеться наш менеджер');                }            } else {                if (date('G')>=10 and date('G')<=14){                    go_sms($phone, 'Дякуємо за замовлення №'.$idOrderText.', воно буде відправлено сьогодні.');                } else {                    go_sms($phone, 'Дякуємо за замовлення №'.$idOrderText.', воно буде відправлено завтра.');                }            }            //якщо день субота        } elseif(date('w')==5){            //якщо година з 10 до 15 включно            if ($notCallBack==0){                if (date('G')>=10 and date('G')<=15){                    go_sms($phone, 'Дякуємо! Замовлення №'.$idOrderText.' прийнято, скоро з Вами зв\'яжеться наш менеджер.');                } else {                    go_sms($phone, 'Дякуємо! Замовлення №'.$idOrderText.' прийнято, після 10-00 з Вами зв\'яжеться наш менеджер.');                }            } else {                if (date('G')<=14){                    go_sms($phone, 'Дякуємо за замовлення №'.$idOrderText.', воно буде відправлено сьогодні.');                } else {                    go_sms($phone, 'Дякуємо за замовлення №'.$idOrderText.', воно буде відправлено в понеділок.');                }            }        } elseif(date('w')==6) {            if ($notCallBack==0){                if (date('G')>=10 and date('G')<=15){                    go_sms($phone, 'Дякуємо! Замовлення №'.$idOrderText.' прийнято, скоро з Вами зв\'яжеться наш менеджер.');                } else {                    if (date('G')<10) {                        go_sms($phone, 'Замовлення №' . $idOrderText . ' прийнято, після 10-00 з Вами зв\'яжеться наш менеджер.');                    } else {                        go_sms($phone, 'Дякуємо! Замовлення №' . $idOrderText . ' прийнято, в понеділок після 10-00 з Вами зв\'яжеться наш менеджер.');                    }                }            } else {                go_sms($phone, 'Дякуємо за замовлення №'.$idOrderText.', воно буде відправлено в понеділок.');            }//            if ($notCallBack==0){//                go_sms($phone, 'Дякуємо! Заказ №'.$idOrderText.' принят, в понедельник после 10-00 с Вами свяжется наш менеджер.');//            } else {//                go_sms($phone, 'Дякуємо за заказ №'.$idOrderText.', он будет отправлен в понедельник.');//            }        } elseif(date('w')==0) {            if ($notCallBack==0){                go_sms($phone, 'Дякуємо! Замовлення №'.$idOrderText.' прийнято, завтра після 10-00 з Вами зв\'яжеться наш менеджер.');            } else {                go_sms($phone, 'Дякуємо за замовлення №'.$idOrderText.', воно буде відправлено в понеділок.');            }        } else {            //у всіх інших випадках            go_sms($phone, 'Замовлення №'.$idOrderText.' принято, післе 10-00 з Вами зв\'яжеться наш менеджер.');        }    }}function getWarehouse($idCity, $userWarehouse = 0, $type = Array("'841339c7-591a-42e2-8233-7a0a00f0ed6f'")){    if (!isset ($_POST['type'])) {        $optionRegion = '<option value="0">Оберіть відділення або поштомат</option>';    } else {        switch ($_POST['type']){            case 0:                $optionRegion = '<option value="0">Оберіть відділення</option>';                break;            case 1:                $optionRegion = '<option value="0">Оберіть поштомат</option>';                break;        }    }    // and `TypeOfWarehouse` IN (".implode(',', $type).")    $sql = "SELECT * FROM `ls_warehouses` where `cityId` = '".$idCity."' ORDER by `id`";    if ($arrayRegion = getArray($sql)){        foreach ($arrayRegion as $v){            if ($userWarehouse!=0 and $userWarehouse==$v['id']){                $optionRegion .= '<option value="'.$v['id'].'" selected>'.$v['name'].'</option>';            } else {                $optionRegion .= '<option value="'.$v['id'].'">'.$v['name'].'</option>';            }        }    }    return ($optionRegion);}function btnPlus($class, $type = 1){    if ($type == 1){        return ('<div class="right" style="display: inline-block; float: right; margin: -5px 10px 0px 0px;" onclick="showHideFiltr(\''.$class.'\');"><i class="fa fa-plus-square-o" id="icon_'.$class.'" aria-hidden="true" style="font-size: 30px;"></i></div>');    } else {        return ('<div class="right" style="display: inline-block; float: right; margin: -5px 10px 0px 0px;" onclick="showHideFiltr(\''.$class.'\');"><i class="fa fa-minus-square-o" id="icon_'.$class.'" aria-hidden="true" style="font-size: 30px;"></i></div>');    }}function getBrandImage($brand){    switch ($brand){        case 110:            return ('<img src="{template}images/brandsNew/spalding.png">');            break;        case 107:            return ('<img src="{template}images/brandsNew/eastbay.png">');            break;        case 103:            return ('<img src="{template}images/brandsNew/mcdavid.png">');            break;        case 36:            return ('<img src="{template}images/brandsNew/under_armour.png">');            break;        case 35:            return ('<img src="{template}images/brandsNew/rbk.png">');            break;        case 34:            return ('<img src="{template}images/brandsNew/nike.png">');            break;        case 32:            return ('<img src="{template}images/brandsNew/kix.png">');            break;        case 31:            return ('<img src="{template}images/brandsNew/jordan.png">');            break;        case 29:            return ('<img src="{template}images/brandsNew/adidas.png">');            break;    }}function getCategorySV($catName, $selectId, $parentId = 0){    $catName = trim($catName);    if (strlen($catName)>0) {        $dopSql = '';        if ($parentId!=0){            $dopSql = " and `parent_param_id` = '".$parentId."' ";        }        $sql = "SELECT * FROM `ls_params_select_values` WHERE `id_params` = '" . $selectId . "' and `text` = '" . mysql_real_escape_string($catName) . "' ".$dopSql.";";        if ($infoParams = getOneString($sql)) {            return ($infoParams['id']);        } else {            $infoCount = getOneString("SELECT COUNT(*) FROM `ls_params_select_values` WHERE `id_params` = '" . $selectId . "';");            mysql_query("INSERT INTO  `ls_params_select_values` (            `type_value`,            `id_params` ,            `position` ,            `visible` ,            `parent_param_id` ,            `text`            )            VALUES (            1,            '" . $selectId . "' ,            '" . $infoCount['COUNT(*)'] . "' ,            '1',            '" . $parentId . "',            '" . mysql_real_escape_string($catName) . "'            );");            $idValue = mysql_insert_id();            mysql_query("                INSERT INTO `ls_translate` (                `type`,                `id_lang`,                `id_elements`,                `text`) VALUES                (                'select_value',                1,                " . $idValue . ",                '" . mysql_real_escape_string($catName) . "')                ");            $idTranslate = mysql_insert_id();            mysql_query("UPDATE `ls_params_select_values` SET `id_translate` = '" . $idTranslate . "' WHERE `id` = '" . $idValue . "';");            return ($idValue);        }    } else {        return (0);    }}function parseSorokaVorona($type, $array){    switch ($type){        //Путешествия и прогулки        case 6:            foreach ($array as $key => $v){                if ($key!=0){                    if ($infoParentCount = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '".mysql_real_escape_string($v[0])."';")){                        $catArray = explode(' > ', $v[10]);//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_26']);//                        }                        mysql_query("                        UPDATE                            `ls_items`                        SET                          `text_1` = '" . mysql_real_escape_string($v[9]) . "' ,                            `text_2` = '" . mysql_real_escape_string($v[0]) . "' ,                            `text_4` = '" . mysql_real_escape_string($v[2]) . "' ,                            `text_11` = '" . mysql_real_escape_string($v[3]) . "' ,                            `price_1` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                            `price_2` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                            `select_1` = '" . getCategorySV($v['7'], 1) . "' ,                            `text_5` = '" . mysql_real_escape_string($v[8]) . "' ,                            `select_2` = '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                            `text_6` = '" . mysql_real_escape_string($v[11]) . "',                            `text_7` = '" . mysql_real_escape_string($v[12]) . "',                            `text_8` = '" . mysql_real_escape_string($v[13]) . "',                            `text_9` = '" . mysql_real_escape_string($v[14]) . "',                            `select_16` = '" . getCategorySV($v[17], 16) . "',                            `select_15` = '" . getCategorySV($v[20], 15) . "',                            `select_33` = '" . getCategorySV($v[19], 33) . "',                            `select_31` = '" . getCategorySV($v[21], 31) . "',                            `select_32` = '" . getOutlet($v[22]) . "'                        WHERE                          `id` = '".$infoParentCount['id']."';                        ");                    } else {                        $catArray = explode(' > ', $v[10]);                        $idParent = 0;//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_26']);//                        }                        $sql = "                            INSERT INTO  `ls_items` (                                `id_card` ,                                `time` ,                                `status` ,                                `text_1` ,                                `text_2` ,                                `text_3` ,                                `text_4` ,                                `text_11` ,                                `price_1` ,                                `price_2` ,                                `select_1` ,                                `text_5` ,                                `select_2`,                                `text_6`,                                `text_7`,                                `text_8`,                                `text_9`,                                `select_16`,                                `select_15`,                                `select_33`,                                `select_31`,                                `select_32`                                )                                VALUES (                                '1',                                '" . time() . "',                                '1',                                '" . mysql_real_escape_string($v[9]) . "' ,                                '" . mysql_real_escape_string($v[0]) . "' ,                                '" . $idParent . "' ,                                '" . mysql_real_escape_string($v[2]) . "' ,                                '" . mysql_real_escape_string($v[3]) . "' ,                                '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                                '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                                '" . getCategorySV($v['7'], 1) . "' ,                                '" . mysql_real_escape_string($v[8]) . "' ,                                '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                                '" . mysql_real_escape_string($v[11]) . "',                                '" . mysql_real_escape_string($v[12]) . "',                                '" . mysql_real_escape_string($v[13]) . "',                                '" . mysql_real_escape_string($v[14]) . "',                                '" . getCategorySV($v[17], 16) . "',                                '" . getCategorySV($v[20], 15) . "',                                '" . getCategorySV($v[19], 33) . "',                                '" . getCategorySV($v[21], 31) . "',                                '" . getOutlet($v[22]) . "'                                );                            ";                        if(!mysql_query($sql)){                            echo $sql;                            exit();                        }                    }                }            }            break;        case 13:            //Товары для родителей            foreach ($array as $key => $v){                if ($key!=0){                    if ($infoParentCount = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '".mysql_real_escape_string($v[0])."';")){                        $catArray = explode(' > ', $v[10]);                        if (strlen($v[1]) != 0) {                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");                            $idParent = $infoParent['id'];                            $v[9] = $infoParent['text_1'];                        }                        $sql = "                        UPDATE                            `ls_items`                        SET                          `text_1` = '" . mysql_real_escape_string($v[9]) . "' ,                            `text_2` = '" . mysql_real_escape_string($v[0]) . "' ,                            `text_4` = '" . mysql_real_escape_string($v[2]) . "' ,                            `text_11` = '" . mysql_real_escape_string($v[3]) . "' ,                            `price_1` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                            `price_2` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                            `select_1` = '" . getCategorySV($v['7'], 1) . "' ,                            `text_5` = '" . mysql_real_escape_string($v[8]) . "' ,                            `select_2` = '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                            `text_6` = '" . mysql_real_escape_string($v[11]) . "',                            `text_7` = '" . mysql_real_escape_string($v[12]) . "',                            `text_8` = '" . mysql_real_escape_string($v[13]) . "',                            `text_9` = '" . mysql_real_escape_string($v[14]) . "',                            `select_16` = '" . getCategorySV($v[17], 16) . "',                            `select_15` = '" . getCategorySV($v[20], 15) . "',                            `select_35` = '" . getCategorySV($v[19], 35) . "',                            `select_31` = '" . getCategorySV($v[21], 35) . "',                            `select_32` = '" . getOutlet($v[22]) . "'                        WHERE                          `id` = '".$infoParentCount['id']."';                        ";                        mysql_query($sql);                    } else {                        $catArray = explode(' > ', $v[10]);                        $idParent = 0;                        if (strlen($v[1]) != 0) {                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");                            $idParent = $infoParent['id'];                            $v[9] = $infoParent['text_1'];                        }                        $sql = "                            INSERT INTO  `ls_items` (                                `id_card` ,                                `time` ,                                `status` ,                                `text_1` ,                                `text_2` ,                                `text_3` ,                                `text_4` ,                                `text_11` ,                                `price_1` ,                                `price_2` ,                                `select_1` ,                                `text_5` ,                                `select_2`,                                `text_6`,                                `text_7`,                                `text_8`,                                `text_9`,                                `select_16`,                                `select_15`,                                `select_35`,                                `select_31`,                                `select_32`                                )                                VALUES (                                '1',                                  '" . time() . "',                                  '1',                                '" . mysql_real_escape_string($v[9]) . "' ,                                  '" . mysql_real_escape_string($v[0]) . "' ,                                  '" . $idParent . "' ,                                  '" . mysql_real_escape_string($v[2]) . "' ,                                  '" . mysql_real_escape_string($v[3]) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                                  '" . getCategorySV($v['7'], 1) . "' ,                                '" . mysql_real_escape_string($v[8]) . "' ,                                '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                                '" . mysql_real_escape_string($v[11]) . "',                                '" . mysql_real_escape_string($v[12]) . "',                                '" . mysql_real_escape_string($v[13]) . "',                                '" . mysql_real_escape_string($v[14]) . "',                                '" . getCategorySV($v[17], 16) . "',                                '" . getCategorySV($v[20], 15) . "',                                '" . getCategorySV($v[19], 35) . "',                                '" . getCategorySV($v[21], 31) . "',                                '" . getOutlet($v[22]) . "'                                );                            ";                        if(!mysql_query($sql)){                            echo $sql;                            exit();                        }                    }                }            }            break;        case 12:            //Одежда обувь            foreach ($array as $key => $v){                if ($key!=0){//                    if ($key==1){//                        print_r ($v);//                        exit();//                    }                    echo $v[0].' - '.$v[1]."\r\n";                    if ($infoParentCount = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '".mysql_real_escape_string($v[0])."';")){                        $catArray = explode(' > ', $v[10]);                        if (strlen($v[1]) != 0) {                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_12` = '" . mysql_real_escape_string($v[1]) . "' and `select_1` != 0 and `text_1` != '';");                            $idParent = $infoParent['id'];                            if (!empty($infoParent['text_1']))                                $v[9] = $infoParent['text_1'];                            if (!empty($infoParent['select_1']))                                $v[7] = getOneValueText($infoParent['select_1']);                            $v[8] = $infoParent['text_5'];                            $v[11] = $infoParent['text_6'];                            $v[12] = $infoParent['text_7'];                            $v[13] = $infoParent['text_8'];                            $v[14] = $infoParent['text_9'];                            $v[17] = getOneValueText($infoParent['select_16']);                            //унікальні                            if ($infoParent['select_36']!='["608"]')                                $arrayPol = json_decode($infoParent['select_36'],true);                        }                        if (!empty($v[19]) and !isset($arrayPol)){                            $arrPol = explode('/', $v[19]);                            $arrayPol = Array();                            foreach ($arrPol as $onePol){                                $arrayPol[] = getCategorySV(trim($onePol), 36);                            }                        }                        if (!empty($v[22])){                            $typeOdyag = getCategorySV($v[22], 27);                        } else {                            $typeOdyag = getCategorySV($v[20], 27);                        }                        $sql = "                        UPDATE                            `ls_items`                        SET                            `text_1` = '" . mysql_real_escape_string($v[9]) . "' ,                            `text_3` = '0' ,                            `text_2` = '" . mysql_real_escape_string($v[0]) . "' ,                            `text_4` = '" . mysql_real_escape_string($v[2]) . "' ,                            `text_11` = '" . mysql_real_escape_string($v[3]) . "' ,                            `price_1` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                            `price_2` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                            `select_1` = '" . getCategorySV($v[7], 1) . "' ,                            `text_5` = '" . mysql_real_escape_string($v[8]) . "' ,                            `select_2` = '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                            `text_6` = '" . mysql_real_escape_string($v[11]) . "',                            `text_7` = '" . mysql_real_escape_string($v[12]) . "',                            `text_8` = '" . mysql_real_escape_string($v[13]) . "',                            `text_9` = '" . mysql_real_escape_string($v[14]) . "',                            `select_16` = '" . getCategorySV($v[17], 16) . "',                            `select_15` = '" . getCategorySV($v[24], 15) . "',                            `select_27` = '" . $typeOdyag . "',                            `select_28` = '" . getCategorySV($v[23], 28) . "',                            `select_29` = '" . getCategorySV($v[21], 29) . "',                            `select_31` = '" . getCategorySV($v[25], 31) . "',                            `select_32` = '" . getOutlet($v[26]) . "',                            `text_12` = '".mysql_real_escape_string($v[1])."',                            `select_36` = '".json_encode($arrayPol)."'                        WHERE                          `id` = '".$infoParentCount['id']."';                        ";//                        if ($v[0]=='clcr0001-3-4'){//                            print $sql;//                            exit();//                        }                        mysql_query($sql);                    } else {                        $catArray = explode(' > ', $v[10]);                        $idParent = 0;                        if (strlen($v[1]) != 0) {                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_12` = '" . mysql_real_escape_string($v[1]) . "' and `select_1` != 0 and `text_1` != '';");                            $idParent = $infoParent['id'];                            if (!empty($infoParent['text_1']))                                $v[9] = $infoParent['text_1'];                            if (!empty($infoParent['select_1']))                                $v[7] = getOneValueText($infoParent['select_1']);                            $v[8] = $infoParent['text_5'];                            $v[11] = $infoParent['text_6'];                            $v[12] = $infoParent['text_7'];                            $v[13] = $infoParent['text_8'];                            $v[14] = $infoParent['text_9'];                            $v[17] = getOneValueText($infoParent['select_16']);                            //унікальні                            $arrayPol = json_decode($infoParent['select_36'],true);                        }                        if (!empty($v[19]) and !isset($arrayPol)){                            $arrPol = explode('/', $v[19]);                            $arrayPol = Array();                            foreach ($arrPol as $onePol){                                $arrayPol[] = getCategorySV(trim($onePol), 36);                            }                        }                        $sql = "                            INSERT INTO  `ls_items` (                                `id_card` ,                                `time` ,                                `status` ,                                `text_12`,                                `text_1` ,                                `text_2` ,                                `text_3` ,                                `text_4` ,                                `text_11` ,                                `price_1` ,                                `price_2` ,                                `select_1` ,                                `text_5` ,                                `select_2`,                                `text_6`,                                `text_7`,                                `text_8`,                                `text_9`,                                `select_16`,                                `select_15`,                                `select_27`,                                `select_28`,                                `select_29`,                                `select_31`,                                `select_32`,                                `select_36`                                )                                VALUES (                                '1',                                  '" . time() . "',                                  '1',                                '".mysql_real_escape_string($v[1])."',                                '" . mysql_real_escape_string($v[9]) . "' ,                                '" . mysql_real_escape_string($v[0]) . "' ,                                  '0' ,                                '" . mysql_real_escape_string($v[2]) . "' ,                                  '" . mysql_real_escape_string($v[3]) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                                  '" . getCategorySV($v[7], 1) . "' ,                                '" . mysql_real_escape_string($v[8]) . "' ,                                '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                                '" . mysql_real_escape_string($v[11]) . "',                                '" . mysql_real_escape_string($v[12]) . "',                                '" . mysql_real_escape_string($v[13]) . "',                                '" . mysql_real_escape_string($v[14]) . "',                                '" . getCategorySV($v[17], 16) . "',                                '" . getCategorySV($v[24], 15) . "',                                '" . $typeOdyag . "',                                '" . getCategorySV($v[23], 28) . "',                                '" . getCategorySV($v[21], 29) . "',                                '" . getCategorySV($v[25], 31) . "',                                '" . getOutlet($v[26]) . "',                                '".json_encode($arrayPol)."'                                );                            ";                        if(!mysql_query($sql)){                            echo $sql;                            exit();                        }                    }                }            }            break;        case 9:            //Кормление            foreach ($array as $key => $v){                if ($key!=0){                    if ($infoParentCount = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '".mysql_real_escape_string($v[0])."';")){                        $catArray = explode(' > ', $v[10]);//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_26']);//                        }                        $sql = "                        UPDATE                            `ls_items`                        SET                          `text_1` = '" . mysql_real_escape_string($v[9]) . "' ,                              `text_2` = '" . mysql_real_escape_string($v[0]) . "' ,                              `text_4` = '" . mysql_real_escape_string($v[2]) . "' ,                              `text_11` = '" . mysql_real_escape_string($v[3]) . "' ,                              `price_1` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                             `price_2` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                              `select_1` = '" . getCategorySV($v['7'], 1) . "' ,                            `text_5` = '" . mysql_real_escape_string($v[8]) . "' ,                            `select_2` = '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                            `text_6` = '" . mysql_real_escape_string($v[11]) . "',                            `text_7` = '" . mysql_real_escape_string($v[12]) . "',                            `text_8` = '" . mysql_real_escape_string($v[13]) . "',                            `text_9` = '" . mysql_real_escape_string($v[14]) . "',                            `select_16` = '" . getCategorySV($v[17], 16) . "',                            `select_15` = '" . getCategorySV($v[20], 15) . "',                            `select_26` = '" . getCategorySV($v[19], 26) . "',                            `select_31` = '" . getCategorySV($v[21], 31) . "',                            `select_32` = '" . getOutlet($v[22]) . "',                            `text_13` = '".$v['23']."',                            `sporidneni` = '".$v['24']."'                        WHERE                          `id` = '".$infoParentCount['id']."';                        ";                        if ($infoParentCount['id']==3968) {                            echo $sql;                            exit();                        }                        mysql_query($sql);                    } else {                        $catArray = explode(' > ', $v[10]);                        $idParent = 0;//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_26']);//                        }                        $sql = "                            INSERT INTO  `ls_items` (                                `id_card` ,                                `time` ,                                `status` ,                                `text_1` ,                                `text_2` ,                                `text_3` ,                                `text_4` ,                                `text_11` ,                                `price_1` ,                                `price_2` ,                                `select_1` ,                                `text_5` ,                                `select_2`,                                `text_6`,                                `text_7`,                                `text_8`,                                `text_9`,                                `select_16`,                                `select_15`,                                `select_25`,                                `select_31`,                                `select_32`                                )                                VALUES (                                '1',                                  '" . time() . "',                                  '1',                                '" . mysql_real_escape_string($v[9]) . "' ,                                  '" . mysql_real_escape_string($v[0]) . "' ,                                  '" . $idParent . "' ,                                  '" . mysql_real_escape_string($v[2]) . "' ,                                  '" . mysql_real_escape_string($v[3]) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                                  '" . getCategorySV($v['7'], 1) . "' ,                                '" . mysql_real_escape_string($v[8]) . "' ,                                '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                                '" . mysql_real_escape_string($v[11]) . "',                                '" . mysql_real_escape_string($v[12]) . "',                                '" . mysql_real_escape_string($v[13]) . "',                                '" . mysql_real_escape_string($v[14]) . "',                                '" . getCategorySV($v[17], 16) . "',                                '" . getCategorySV($v[20], 15) . "',                                '" . getCategorySV($v[19], 26) . "',                                '" . getCategorySV($v[20], 31) . "',                                '" . getOutlet($v[22]) . "'                                );                            ";                        if(!mysql_query($sql)){                            echo $sql;                            exit();                        }                    }                }            }            break;        case 11:            //Транспорт            foreach ($array as $key => $v){                if ($key!=0){                    if ($infoParentCount = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '".mysql_real_escape_string($v[0])."';")){                        $catArray = explode(' > ', $v[10]);//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_25']);//                        }                        mysql_query("                        UPDATE                            `ls_items`                        SET                          `text_1` = '" . mysql_real_escape_string($v[9]) . "' ,                              `text_2` = '" . mysql_real_escape_string($v[0]) . "' ,                              `text_4` = '" . mysql_real_escape_string($v[2]) . "' ,                              `text_11` = '" . mysql_real_escape_string($v[3]) . "' ,                              `price_1` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                             `price_2` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                              `select_1` = '" . getCategorySV($v['7'], 1) . "' ,                            `text_5` = '" . mysql_real_escape_string($v[8]) . "' ,                            `select_2` = '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                            `text_6` = '" . mysql_real_escape_string($v[11]) . "',                            `text_7` = '" . mysql_real_escape_string($v[12]) . "',                            `text_8` = '" . mysql_real_escape_string($v[13]) . "',                            `text_9` = '" . mysql_real_escape_string($v[14]) . "',                            `select_16` = '" . getCategorySV($v[17], 16) . "',                            `select_15` = '" . getCategorySV($v[20], 15) . "',                            `select_25` = '" . getCategorySV($v[19], 25) . "',                            `select_31` = '" . getCategorySV($v[21], 31) . "',                            `select_32` = '" . getOutlet($v[22]) . "' ,                            `select_24` = '" . getCategorySV($v[23], 24) . "',                            `text_13` = '".intval($v[24])."',                            `sporidneni` = '" . mysql_real_escape_string($v[25]) . "'                        WHERE                          `id` = '".$infoParentCount['id']."';                        ");                    } else {                        $catArray = explode(' > ', $v[10]);                        $idParent = 0;//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_25']);//                        }                        $sql = "                            INSERT INTO  `ls_items` (                                `id_card` ,                                `time` ,                                `status` ,                                `text_1` ,                                `text_2` ,                                `text_3` ,                                `text_4` ,                                `text_11` ,                                `price_1` ,                                `price_2` ,                                `select_1` ,                                `text_5` ,                                `select_2`,                                `text_6`,                                `text_7`,                                `text_8`,                                `text_9`,                                `select_16`,                                `select_15`,                                `select_25`,                                `select_31`,                                `select_32`,                                `select_24`,                                `text_13`                                )                                VALUES (                                '1',                                  '" . time() . "',                                  '1',                                '" . mysql_real_escape_string($v[9]) . "' ,                                  '" . mysql_real_escape_string($v[0]) . "' ,                                  '" . $idParent . "' ,                                  '" . mysql_real_escape_string($v[2]) . "' ,                                  '" . mysql_real_escape_string($v[3]) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                                  '" . getCategorySV($v['7'], 1) . "' ,                                '" . mysql_real_escape_string($v[8]) . "' ,                                '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                                '" . mysql_real_escape_string($v[11]) . "',                                '" . mysql_real_escape_string($v[12]) . "',                                '" . mysql_real_escape_string($v[13]) . "',                                '" . mysql_real_escape_string($v[14]) . "',                                '" . getCategorySV($v[17], 16) . "',                                '" . getCategorySV($v[20], 15) . "',                                '" . getCategorySV($v[19], 25) . "',                                '" . getCategorySV($v[21], 31) . "',                                '" . getOutlet($v[22]). "',                                '" . getCategorySV($v[23], 24) . "',                                '".intval($v['24'])."'                                );                            ";                        if(!mysql_query($sql)){                            echo $sql;                            exit();                        }                    }                }            }            break;        case 10:            //Игрушки            foreach ($array as $key => $v){                if ($key!=0){                    if ($infoParentCount = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '".mysql_real_escape_string($v[0])."';")){                        $catArray = explode(' > ', $v[10]);//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_23']);//                            $v[20] = getOneValueText($infoParent['select_24']);//                        }//                        if ($v[0]=='503.200.99'){//                            print_r ($v);//                            echo getCategorySV($catArray[0], 2)."\r\n";//                            echo getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2));//                            exit();//                        }                        mysql_query("                        UPDATE                            `ls_items`                        SET                          `text_1` = '" . mysql_real_escape_string($v[9]) . "' ,                              `text_2` = '" . mysql_real_escape_string($v[0]) . "' ,                              `text_4` = '" . mysql_real_escape_string($v[2]) . "' ,                              `text_11` = '" . mysql_real_escape_string($v[3]) . "' ,                              `price_1` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                             `price_2` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                              `select_1` = '" . getCategorySV($v['7'], 1) . "' ,                            `text_5` = '" . mysql_real_escape_string($v[8]) . "' ,                            `select_2` = '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                            `text_6` = '" . mysql_real_escape_string($v[11]) . "',                            `text_7` = '" . mysql_real_escape_string($v[12]) . "',                            `text_8` = '" . mysql_real_escape_string($v[13]) . "',                            `text_9` = '" . mysql_real_escape_string($v[14]) . "',                            `select_16` = '" . getCategorySV($v[17], 16) . "',                            `select_15` = '" . getCategorySV($v[21], 15) . "',                            `select_23` = '" . getCategorySV($v[19], 23) . "',                            `select_24` = '" . getCategorySV($v[20], 24) . "',                            `select_31` = '" . getCategorySV($v[22], 31) . "',                            `select_32` = '" . getOutlet($v[23]) . "',                            `text_13` = '".intval($v[24])."',                            `sporidneni` = '" . mysql_real_escape_string($v[25]) . "'                        WHERE                          `id` = '".$infoParentCount['id']."';                        ");                    } else {                        $catArray = explode(' > ', $v[10]);                        $idParent = 0;//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_23']);//                            $v[20] = getOneValueText($infoParent['select_24']);//                        }                        $sql = "                            INSERT INTO  `ls_items` (                                `id_card` ,                                `time` ,                                `status` ,                                `text_1` ,                                `text_2` ,                                `text_3` ,                                `text_4` ,                                `text_11` ,                                `price_1` ,                                `price_2` ,                                `select_1` ,                                `text_5` ,                                `select_2`,                                `text_6`,                                `text_7`,                                `text_8`,                                `text_9`,                                `select_16`,                                `select_15`,                                `select_23`,                                `select_24`,                                `select_31`,                                `select_32`                                )                                VALUES (                                '1',                                  '" . time() . "',                                  '1',                                '" . mysql_real_escape_string($v[9]) . "' ,                                  '" . mysql_real_escape_string($v[0]) . "' ,                                  '" . $idParent . "' ,                                  '" . mysql_real_escape_string($v[2]) . "' ,                                  '" . mysql_real_escape_string($v[3]) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                                  '" . getCategorySV($v['7'], 1) . "' ,                                '" . mysql_real_escape_string($v[8]) . "' ,                                '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                                '" . mysql_real_escape_string($v[11]) . "',                                '" . mysql_real_escape_string($v[12]) . "',                                '" . mysql_real_escape_string($v[13]) . "',                                '" . mysql_real_escape_string($v[14]) . "',                                '" . getCategorySV($v[17], 16) . "',                                '" . getCategorySV($v[21], 15) . "',                                '" . getCategorySV($v[19], 23) . "',                                '" . getCategorySV($v[20], 24) . "',                                '" . getCategorySV($v[22], 31) . "',                                '" . getOutlet($v[23]) . "'                                );                            ";                        if(!mysql_query($sql)){                            echo $sql;                            exit();                        }                    }                }            }            break;        case 15:            //Гигиена и уход            foreach ($array as $key => $v){                if ($key!=0){                    if ($infoParentCount = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '".mysql_real_escape_string($v[0])."';")){                        $catArray = explode(' > ', $v[10]);//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_22']);//                        }                        mysql_query("                        UPDATE                            `ls_items`                        SET                          `text_1` = '" . mysql_real_escape_string($v[9]) . "' ,                              `text_2` = '" . mysql_real_escape_string($v[0]) . "' ,                              `text_4` = '" . mysql_real_escape_string($v[2]) . "' ,                              `text_11` = '" . mysql_real_escape_string($v[3]) . "' ,                              `price_1` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                             `price_2` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                              `select_1` = '" . getCategorySV($v['7'], 1) . "' ,                            `text_5` = '" . mysql_real_escape_string($v[8]) . "' ,                            `select_2` = '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                            `text_6` = '" . mysql_real_escape_string($v[11]) . "',                            `text_7` = '" . mysql_real_escape_string($v[12]) . "',                            `text_8` = '" . mysql_real_escape_string($v[13]) . "',                            `text_9` = '" . mysql_real_escape_string($v[14]) . "',                            `select_16` = '" . getCategorySV($v[17], 16) . "',                            `select_15` = '" . getCategorySV($v[20], 15) . "',                            `select_22` = '" . getCategorySV($v[19], 22) . "',                            `select_31` = '" . getCategorySV($v[21], 31) . "',                            `select_32` = '" . getOutlet($v[22]) . "',                            `text_13` = '".$v['23']."',                            `sporidneni` = '".$v['24']."'                        WHERE                          `id` = '".$infoParentCount['id']."';                        ");                    } else {                        $catArray = explode(' > ', $v[10]);                        $idParent = 0;//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_22']);//                        }                        $sql = "                            INSERT INTO  `ls_items` (                                `id_card` ,                                `time` ,                                `status` ,                                `text_1` ,                                `text_2` ,                                `text_3` ,                                `text_4` ,                                `text_11` ,                                `price_1` ,                                `price_2` ,                                `select_1` ,                                `text_5` ,                                `select_2`,                                `text_6`,                                `text_7`,                                `text_8`,                                `text_9`,                                `select_16`,                                `select_15`,                                `select_22`,                                `select_31`,                                `select_32`                                )                                VALUES (                                '1',                                  '" . time() . "',                                  '1',                                '" . mysql_real_escape_string($v[9]) . "' ,                                  '" . mysql_real_escape_string($v[0]) . "' ,                                  '" . $idParent . "' ,                                  '" . mysql_real_escape_string($v[2]) . "' ,                                  '" . mysql_real_escape_string($v[3]) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                                  '" . getCategorySV($v['7'], 1) . "' ,                                '" . mysql_real_escape_string($v[8]) . "' ,                                '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                                '" . mysql_real_escape_string($v[11]) . "',                                '" . mysql_real_escape_string($v[12]) . "',                                '" . mysql_real_escape_string($v[13]) . "',                                '" . mysql_real_escape_string($v[14]) . "',                                '" . getCategorySV($v[17], 16) . "',                                '" . getCategorySV($v[20], 15) . "',                                '" . getCategorySV($v[19], 22) . "',                                '" . getCategorySV($v[21], 31) . "',                                '" . getOutlet($v[22]) . "'                                );                            ";                        if(!mysql_query($sql)){                            echo $sql;                            exit();                        }                    }                }            }            break;        //Детская комната        case 8:            foreach ($array as $key => $v){                if ($key!=0){                    if ($infoParentCount = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '".mysql_real_escape_string($v[0])."';")){                        $catArray = explode(' > ', $v[10]);//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_21']);//                        }                        mysql_query("                        UPDATE                            `ls_items`                        SET                          `text_1` = '" . mysql_real_escape_string($v[9]) . "' ,                              `text_2` = '" . mysql_real_escape_string($v[0]) . "' ,                              `text_4` = '" . mysql_real_escape_string($v[2]) . "' ,                              `text_11` = '" . mysql_real_escape_string($v[3]) . "' ,                              `price_1` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                             `price_2` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                              `select_1` = '" . getCategorySV($v['7'], 1) . "' ,                            `text_5` = '" . mysql_real_escape_string($v[8]) . "' ,                            `select_2` = '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                            `text_6` = '" . mysql_real_escape_string($v[11]) . "',                            `text_7` = '" . mysql_real_escape_string($v[12]) . "',                            `text_8` = '" . mysql_real_escape_string($v[13]) . "',                            `text_9` = '" . mysql_real_escape_string($v[14]) . "',                            `select_16` = '" . getCategorySV($v[17], 16) . "',                            `select_15` = '" . getCategorySV($v[20], 15) . "',                            `select_21` = '" . getCategorySV($v[19], 21) . "',                            `select_31` = '" . getCategorySV($v[21], 31) . "',                            `select_32` = '" . getOutlet($v[22]) . "',                            `sporidneni` = '" . mysql_real_escape_string($v[24]) . "',                            `text_13` = '".$v['23']."',                            `sporidneni` = '".$v['24']."'                        WHERE                          `id` = '".$infoParentCount['id']."';                        ");                    } else {                        $catArray = explode(' > ', $v[10]);                        $idParent = 0;//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_21']);//                        }                        $sql = "                            INSERT INTO  `ls_items` (                                `id_card` ,                                `time` ,                                `status` ,                                `text_1` ,                                `text_2` ,                                `text_3` ,                                `text_4` ,                                `text_11` ,                                `price_1` ,                                `price_2` ,                                `select_1` ,                                `text_5` ,                                `select_2`,                                `text_6`,                                `text_7`,                                `text_8`,                                `text_9`,                                `select_16`,                                `select_15`,                                `select_21`,                                `select_31`,                                `select_32`                                )                                VALUES (                                '1',                                  '" . time() . "',                                  '1',                                '" . mysql_real_escape_string($v[9]) . "' ,                                  '" . mysql_real_escape_string($v[0]) . "' ,                                  '" . $idParent . "' ,                                  '" . mysql_real_escape_string($v[2]) . "' ,                                  '" . mysql_real_escape_string($v[3]) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                                  '" . getCategorySV($v['7'], 1) . "' ,                                '" . mysql_real_escape_string($v[8]) . "' ,                                '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                                '" . mysql_real_escape_string($v[11]) . "',                                '" . mysql_real_escape_string($v[12]) . "',                                '" . mysql_real_escape_string($v[13]) . "',                                '" . mysql_real_escape_string($v[14]) . "',                                '" . getCategorySV($v[17], 16) . "',                                '" . getCategorySV($v[20], 15) . "',                                '" . getCategorySV($v[19], 21) . "',                                '" . getCategorySV($v[21], 31) . "',                                '" . getOutlet($v[22]) . "'                                );                            ";                        if(!mysql_query($sql)){                            echo $sql;                            exit();                        }                    }                }            }            break;        //Автокресла        case 7:            foreach ($array as $key => $v){                if ($key!=0){                    if ($infoParentCount = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '".mysql_real_escape_string($v[0])."';")){                        $catArray = explode(' > ', $v[10]);//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_20']);//                            $v[21] = getOneValueText($infoParent['select_18']);//                            $v[22] = getOneValueText($infoParent['select_19']);//                            $v[20] = getOneValueText($infoParent['select_17']);//                            $v[21] = getOneValueText($infoParent['select_18']);//                            $v[22] = getOneValueText($infoParent['select_19']);//                        }                        mysql_query("                        UPDATE                            `ls_items`                        SET                          `text_1` = '" . mysql_real_escape_string($v[9]) . "' ,                              `text_2` = '" . mysql_real_escape_string($v[0]) . "' ,                              `text_4` = '" . mysql_real_escape_string($v[2]) . "' ,                              `text_11` = '" . mysql_real_escape_string($v[3]) . "' ,                              `price_1` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                             `price_2` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                              `select_1` = '" . getCategorySV($v['7'], 1) . "' ,                            `text_5` = '" . mysql_real_escape_string($v[8]) . "' ,                            `select_2` = '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                            `text_6` = '" . mysql_real_escape_string($v[11]) . "',                            `text_7` = '" . mysql_real_escape_string($v[12]) . "',                            `text_8` = '" . mysql_real_escape_string($v[13]) . "',                            `text_9` = '" . mysql_real_escape_string($v[14]) . "',                            `select_16` = '" . getCategorySV($v[17], 16) . "',                            `select_20` = '" . getCategorySV($v[19], 20) . "',                            `select_15` = '" . getCategorySV($v[23], 15) . "',                            `select_17` = '" . getCategorySV($v[20], 17) . "',                            `select_18` = '" . getCategorySV($v[21], 18) . "',                            `select_19` = '" . getCategorySV($v[22], 19) . "',                            `select_31` = '" . getCategorySV($v[24], 31) . "',                            `select_32` = '" . getOutlet($v[25]) . "'                        WHERE                          `id` = '".$infoParentCount['id']."';                        ");                    } else {                        $catArray = explode(' > ', $v[10]);                        $idParent = 0;//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = $infoParent['select_16'];//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_20']);//                            $v[21] = getOneValueText($infoParent['select_18']);//                            $v[22] = getOneValueText($infoParent['select_19']);//                            $v[20] = getOneValueText($infoParent['select_17']);//                            $v[21] = getOneValueText($infoParent['select_18']);//                            $v[22] = getOneValueText($infoParent['select_19']);//                        }                        $sql = "                            INSERT INTO  `ls_items` (                                `id_card` ,                                `time` ,                                `status` ,                                `text_1` ,                                `text_2` ,                                `text_3` ,                                `text_4` ,                                `text_11` ,                                `price_1` ,                                `price_2` ,                                `select_1` ,                                `text_5` ,                                `select_2`,                                `text_6`,                                `text_7`,                                `text_8`,                                `text_9`,                                `select_16`,                                `select_20`,                                `select_15`,                                `select_17`,                                `select_18`,                                `select_19`,                                `select_31`,                                `select_32`                                )                                VALUES (                                '1',                                  '" . time() . "',                                  '1',                                '" . mysql_real_escape_string($v[9]) . "' ,                                  '" . mysql_real_escape_string($v[0]) . "' ,                                  '" . $idParent . "' ,                                  '" . mysql_real_escape_string($v[2]) . "' ,                                  '" . mysql_real_escape_string($v[3]) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                                  '" . getCategorySV($v['7'], 1) . "' ,                                '" . mysql_real_escape_string($v[8]) . "' ,                                '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                                '" . mysql_real_escape_string($v[11]) . "',                                '" . mysql_real_escape_string($v[12]) . "',                                '" . mysql_real_escape_string($v[13]) . "',                                '" . mysql_real_escape_string($v[14]) . "',                                '" . getCategorySV($v[17], 16) . "',                                '" . getCategorySV($v[19], 20) . "',                                '" . getCategorySV($v[23], 15) . "',                                '" . getCategorySV($v[20], 17) . "',                                '" . getCategorySV($v[21], 18) . "',                                '" . getCategorySV($v[22], 19) . "',                                '" . getCategorySV($v[24], 31) . "',                                '" . getOutlet($v[25]) . "'                                );                            ";                        if(!mysql_query($sql)){                            echo $sql;                            exit();                        }                    }                }            }            break;        case 3:            //Коляски            foreach ($array as $key => $v){                if ($key!=0){                    if ($infoParentCount = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '".mysql_real_escape_string($v[0])."';")){                        $catArray = explode(' > ', $v[10]);//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_3']);//                            $v[20] = getOneValueText($infoParent['select_4']);//                            $v[21] = getOneValueText($infoParent['select_5']);//                            $v[22] = getOneValueText($infoParent['select_6']);//                            $v[23] = getOneValueText($infoParent['select_7']);//                            $v[24] = getOneValueText($infoParent['select_8']);//                            $v[25] = getOneValueText($infoParent['select_9']);//                            $v[26] = getOneValueText($infoParent['select_10']);//                            $v[27] = getOneValueText($infoParent['select_11']);//                            $v[28] = getOneValueText($infoParent['select_12']);//                            $v[29] = getOneValueText($infoParent['select_13']);//                            $v[30] = getOneValueText($infoParent['select_14']);//                        }                        $sql = "                        UPDATE                            `ls_items`                        SET                          `text_1` = '" . mysql_real_escape_string($v[9]) . "' ,                            `text_2` = '" . mysql_real_escape_string($v[0]) . "' ,                            `text_4` = '" . mysql_real_escape_string($v[2]) . "' ,                            `text_11` = '" . mysql_real_escape_string($v[3]) . "' ,                            `price_1` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                            `price_2` = '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                            `select_1` = '" . getCategorySV($v['7'], 1) . "' ,                            `text_5` = '" . mysql_real_escape_string($v[8]) . "' ,                            `select_2` = '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                            `text_6` = '" . mysql_real_escape_string($v[11]) . "',                            `text_7` = '" . mysql_real_escape_string($v[12]) . "',                            `text_8` = '" . mysql_real_escape_string($v[13]) . "',                            `text_9` = '" . mysql_real_escape_string($v[14]) . "',                            `text_13` = '" . intval($v[34]) . "',                            `select_16` = '" . getCategorySV($v[17], 16) . "',                            `select_3` = '" . getCategorySV($v[19], 3) . "',                            `select_4` = '" . getCategorySV($v[20], 4) . "',                            `select_5` = '" . getCategorySV($v[21], 5) . "',                            `select_6` = '" . getCategorySV($v[22], 6) . "',                            `select_7` = '" . getCategorySV($v[23], 7) . "',                            `select_8` = '" . getCategorySV($v[24], 8) . "',                            `select_9` = '" . getCategorySV($v[25], 9) . "',                            `select_10` = '" . getCategorySV($v[26], 10) . "',                            `select_11` = '" . getCategorySV($v[27], 11) . "',                            `select_12` = '" . getCategorySV($v[28], 12) . "',                            `select_13` = '" . getCategorySV($v[29], 13) . "',                            `select_14` = '" . getCategorySV($v[30], 14) . "',                            `select_15` = '" . getCategorySV($v[31], 15) . "',                            `select_31` = '" . getCategorySV($v[32], 31) . "',                            `select_32` = '" . getOutlet($v[33]) . "',                            `sporidneni` = '" . mysql_real_escape_string($v[35]) . "'                        WHERE                          `id` = '".$infoParentCount['id']."';                        ";                        mysql_query($sql);                    } else {                        $catArray = explode(' > ', $v[10]);                        $idParent = 0;//                        if (strlen($v[1]) != 0) {//                            $infoParent = getOneString("SELECT * FROM `ls_items` WHERE `text_2` = '" . mysql_real_escape_string($v[1]) . "';");//                            $idParent = $infoParent['id'];//                            $v[9] = $infoParent['text_1'];//                            $v[7] = getOneValueText($infoParent['select_1']);//                            $v[8] = $infoParent['text_5'];//                            $v[11] = $infoParent['text_6'];//                            $v[12] = $infoParent['text_7'];//                            $v[13] = $infoParent['text_8'];//                            $v[14] = $infoParent['text_9'];//                            $v[17] = getOneValueText($infoParent['select_16']);//                            //унікальні//                            $v[19] = getOneValueText($infoParent['select_3']);//                            $v[20] = getOneValueText($infoParent['select_4']);//                            $v[21] = getOneValueText($infoParent['select_5']);//                            $v[22] = getOneValueText($infoParent['select_6']);//                            $v[23] = getOneValueText($infoParent['select_7']);//                            $v[24] = getOneValueText($infoParent['select_8']);//                            $v[25] = getOneValueText($infoParent['select_9']);//                            $v[26] = getOneValueText($infoParent['select_10']);//                            $v[27] = getOneValueText($infoParent['select_11']);//                            $v[28] = getOneValueText($infoParent['select_12']);//                            $v[29] = getOneValueText($infoParent['select_13']);//                            $v[30] = getOneValueText($infoParent['select_14']);//                        }                        $sql = "                            INSERT INTO  `ls_items` (                                `id_card` ,                                `time` ,                                `status` ,                                `text_1` ,                                `text_2` ,                                `text_3` ,                                `text_4` ,                                `text_11` ,                                `price_1` ,                                `price_2` ,                                `select_1` ,                                `text_5` ,                                `select_2`,                                `text_6`,                                `text_7`,                                `text_8`,                                `text_9`,                                `select_16`,                                `select_3`,                                `select_4`,                                `select_5`,                                `select_6`,                                `select_7`,                                `select_8`,                                `select_9`,                                `select_10`,                                `select_11`,                                `select_12`,                                `select_13`,                                `select_14`,                                `select_15`,                                `select_31`,                                `select_32`                                )                                VALUES (                                '1',                                  '" . time() . "',                                  '1',                                '" . mysql_real_escape_string($v[9]) . "' ,                                  '" . mysql_real_escape_string($v[0]) . "' ,                                  '" . $idParent . "' ,                                  '" . mysql_real_escape_string($v[2]) . "' ,                                  '" . mysql_real_escape_string($v[3]) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[4])) . "' ,                                  '" . mysql_real_escape_string(str_replace(' грн.', '', $v[5])) . "' ,                                  '" . getCategorySV($v['7'], 1) . "' ,                                '" . mysql_real_escape_string($v[8]) . "' ,                                '" . getCategorySV($catArray[1], 2, getCategorySV($catArray[0], 2)) . "' ,                                '" . mysql_real_escape_string($v[11]) . "',                                '" . mysql_real_escape_string($v[12]) . "',                                '" . mysql_real_escape_string($v[13]) . "',                                '" . mysql_real_escape_string($v[14]) . "',                                '" . getCategorySV($v[17], 16) . "',                                '" . getCategorySV($v[19], 3) . "',                                '" . getCategorySV($v[20], 4) . "',                                '" . getCategorySV($v[21], 5) . "',                                '" . getCategorySV($v[22], 6) . "',                                '" . getCategorySV($v[23], 7) . "',                                '" . getCategorySV($v[24], 8) . "',                                '" . getCategorySV($v[25], 9) . "',                                '" . getCategorySV($v[26], 10) . "',                                '" . getCategorySV($v[27], 11) . "',                                '" . getCategorySV($v[28], 12) . "',                                '" . getCategorySV($v[29], 13) . "',                                '" . getCategorySV($v[30], 14) . "',                                '" . getCategorySV($v[31], 15) . "',                                '" . getCategorySV($v[32], 31) . "',                                '" . getOutlet($v[33]) . "'                                );                            ";                        mysql_query($sql);                    }                }            }            break;    }}function getOutlet($outLet){    if ($outLet=="outlet"){        return (451);    } else {        return(452);    }}function getOneItem($v, $oneItem, $withModel = 1){    $dopStyleItemShop = '';//    print_r ($v);//    $infoLastItem = getOneString("SELECT `id` FROM `ls_items` ORDER by `id` DESC LIMIT 0,1");    $oneItem = str_replace('{name}', $v['text_1'], $oneItem);    $oneItem = str_replace('{nameEmpty}', str_replace(' - ', ' - ', $v['text_1']).' '.getOneValueText($v['select_1']).' '.(($withModel==1) ? $v['text_4'] : '').' ', $oneItem);    $oneItem = str_replace('{id}', $v['id'], $oneItem);    $oneItem = str_replace('{brand}', getOneValueText($v['select_1']), $oneItem);    $oneItem = str_replace('{category}', getOneValueText($v['select_2']), $oneItem);    if ($v['select_5']==78){        $oneItem = str_replace('{opacity}', ' style="opacity: 0.3;"', $oneItem);    } else {        $oneItem = str_replace('{opacity}', '', $oneItem);    }    if ($v['price_2']!=0 and $v['price_2']!=$v['price_1']) {        $oneItem = str_replace('{price}', $v['price_2'], $oneItem);    } else {        $oneItem = str_replace('{price}', $v['price_1'], $oneItem);    }    $oneItem = str_replace('{link}', generateItemLink ($v['id']), $oneItem);    $addAct = '';//    echo $v['price_2']." - ".$v['price_1']."\r\n";    if ($v['price_2']!=0.00 and $v['price_2']!=$v['price_1']){        $oneItem = str_replace('{strike}', '<span style="text-decoration: line-through; color:#7c7c7c; font-size: 10px;">', $oneItem);        $oneItem = str_replace('{/strike}', '</span>', $oneItem);        $oneItem = str_replace('{price_discount}', '<span style="font-size: 1em;">'.$v['price_2'].'</span>', $oneItem);        $oneItem = str_replace('{price_old}', '<span style="font-size: 1em;">'.$v['price_1'].'</span>', $oneItem);        if (MOBILEVER==0){//            $addAct = '<div style="position: absolute; top: 0px; left: 0px; padding: 5px 15px; text-align: center; background-color: rgba(240,0,9,0.7); color: #FFF; font-size: 1.2em;"> Акція!</div>';        } else {//            $addAct = '<div style="position: absolute; top: 0px; left: 0px; padding: 0px 10px; text-align: center; background-color: rgba(240,0,9,0.7); color: #FFF; font-size: 1.2em;"> Акція!</div>';        }    } else {        $oneItem = str_replace('{price_old}', '', $oneItem);        $oneItem = str_replace('{strike}', '', $oneItem);        $oneItem = str_replace('{/strike}', '', $oneItem);        $oneItem = str_replace('{price_discount}', $v['price_1'], $oneItem);    }    if ($v['select_32']==451){//        $addAct = '<div style="position: absolute; top: 0px;  left: 0px; padding: 5px 15px; text-align: center; background-color: rgba(240,211,0,0.69); color: #FFF; font-size: 1.2em;"> OUTLET</div>';    }//    $addAct = $infoLastItem['id'].'-'.$v['id'];    if ($infoLastItem['id']<($v['id']+20) or $v['select_13']==255){//        $addAct = '<div style="position: absolute;  top: 0px; left: 0px; padding: 5px 15px; text-align: center; background-color: rgba(59,240,78,0.68);  color: #FFF; font-size: 1.2em;"> Новинка!</div>';    }    if ($v['text_13']==5){//        $addAct = '<div style="position: absolute; top: 0px;  left: 0px; padding: 5px 15px; text-align: center; background-color: rgba(240,52,0,0.67); color: #FFF; font-size: 1.2em;"> Товар закінчується</div>';    }    if ($infoGift = getOneString("SELECT * FROM `ls_giftToItem` WHERE `itemId` = '".$v['id']."' AND `price` = '0.01'")){//        $addAct = '<div style="position: absolute; top: 0px;  left: 0px; padding: 5px 15px; text-align: center; background-color: rgba(240,52,0,0.67); color: #FFF; font-size: 1.2em;"> + Подарунок</div>';    }    $imgStyle = '';    if ($v['select_15']==758){        $imgStyle = '-webkit-filter: grayscale(100%);        -moz-filter: grayscale(100%);        -ms-filter: grayscale(100%);        -o-filter: grayscale(100%);        filter: grayscale(100%);        filter: url(grayscale.svg); /* Firefox 4+ */        filter: gray; /* IE 6-9 */';    }    $oneItem = str_replace("{addAct}", $addAct, $oneItem);    $oneItem = str_replace("{imgStyle}", $imgStyle, $oneItem);    if ($v['text_7']<=0 AND $v['select_12']!=215 AND $v['text_12']==0){        $dopStyleItemShop .= ' opacity: 0.3;';    }    $oneItem = str_replace("{dopStyleItemShop}", 'style="'.$dopStyleItemShop.'"', $oneItem);    //    /*if (time()-$v['time']<2678400){        $oneItem = str_replace('{new}', '<div class="new"><img src="http://og-shop.in.ua/images/new.png"></div>', $oneItem);    } else {        $oneItem = str_replace('{new}', '', $oneItem);    }*/    $oneItem = str_replace('{image}', getImgSoroka($v, 265, 303), $oneItem);    if (substr_count($oneItem,'image_second')){        $oneItem = str_replace('{image_second}', getImgSoroka($v, 265, 303, 1), $oneItem);    }    return ($oneItem);}function getImgSoroka($v, $width = 172, $height = 172, $limit = 0){    global $config;    return($config ['site_url'].'resize_image.php?filename='.urlencode(getMainImage($v['id'],$limit)).'&const=128&width='.$width.'&height='.$height.'&r=255&g=255&b=255');}function getColorArrayItem($v){    if ($array = getArray("SELECT * FROM `ls_items` WHERE `text_3` = '".$v['text_3']."';")){        return ($array);    } else {        return (false);    }}function getDescriptionSoroka($desc){    $desc = str_replace('//', '<br>', $desc);    $desc = str_replace('**', '</strong>', $desc);    $desc = str_replace('*', '<strong>', $desc);    return($desc);}function generateFiltrFromSelectParams($sql, $selectId, $selected = 0, $typeSort = 0){    $array = getValuesSelectParam($selectId, $typeSort);    if ($array)    {        $options = '';        foreach ($array as $v)        {//            if ($selectId==2){//                if ($arrayChild = getArray("SELECT * FROM `ls_params_select_values` WHERE `parent_param_id` = '".$v['parent_param_id']."' and `id_params` = 2")){//                    $arrayToChildId = Array();//                    foreach ($arrayChild as $oneChild){//                        $arrayToChildId[] = $oneChild['id'];//                    }//                    $dopSqlChild = " OR `select_2` IN (".implode(',', $arrayToChildId).")";//                }//            }            $sql = str_replace('GROUP by `text_1`,`select_2`', '', $sql);            $sqlTrue = $sql. ((substr_count($sql, 'where') > 0 ? ' AND ' : ' WHERE '))."              (            `select_".$selectId."` = '".$v['id']."' or `select_".$selectId."` LIKE '%\"".$v['id']."\"%' ".$dopSqlChild."            ) GROUP by `text_1`,`select_2`";            $results = mysql_query($sqlTrue);            $number = mysql_num_rows ($results);            $infoCount['COUNT(*)'] = $number;            if ($infoCount['COUNT(*)']>0) {                if ((is_array($selected) and in_array($v['id'], $selected)) or $selected == $v['id']) {                    $options .= '                        <div class="form-check activeFiltrElement">                             <input class="form-check-input param" type="checkbox" checked name="select|' . $selectId . '|' . $v['id'] . '" value="1" id="select|' . $selectId . '|' . $v['id'] . '">                             <label class="form-check-label" for="select|' . $selectId . '|' . $v['id'] . '">' . $v['text'] . ' ('.$infoCount['COUNT(*)'].')</label>                          </div>                    ';//                    <li><a href="#"><i class="fa fa-angle-right"></i>LEARNING</a> <span>(4)</span></li>                } else {                    $options .= '                        <div class="form-check activeFiltrElement">                             <input class="form-check-input param" type="checkbox" name="select|' . $selectId . '|' . $v['id'] . '" value="1" id="select|' . $selectId . '|' . $v['id'] . '">                             <label class="form-check-label" for="select|' . $selectId . '|' . $v['id'] . '">' . $v['text'] . ' ('.$infoCount['COUNT(*)'].')</label>                          </div>                    ';                }            }        }        $btnNay = '';        if (MOBILEVER==1){//            $btnNay = btnPlus('select_'.$selectId, 1);        } else {//            $btnNay = btnPlus('select_'.$selectId, 0);        }        $tmpNameSelect = return_name_for_id_select_param(2, $selectId);        $arrName = explode('/',$tmpNameSelect['text']);        $name = ' '.$arrName[0];        if (!empty($options)) {            $hide = '';            if (MOBILEVER==1){                $hide = ' style="display: none;"';            }            $filtr = '                <div class="catagory_area blockFiltr product-sidebar__widget mb-30">                <h2 class="product-sidebar__title mb-25">' . $name . '</h2>                <div class="catagory ulSearch blockFiltrBody classStyle select_' . $selectId . '">                ' . $options . '                </div>            </div>        ';            return ($filtr);        } else {            return ("");        }    }}function generateReview($id){    global $infoUser;    $allReview = '';    if ($arrayReview = getArray("SELECT * FROM `ls_reviews` WHERE `idItem` = '".$id."' and `idQuestion` = 0 order by `id` DESC;")){        foreach ($arrayReview as $v){            $allReview .= getOneReview($v);        }    }    $html = '    <hr>    <style>        .rate {    border-bottom-right-radius: 12px;    border-bottom-left-radius: 12px    }        .rating {        display: flex;        flex-direction: row-reverse;        justify-content: center    }        .rating>input {        display: none    }        .rating>label {        position: relative;        width: 1em;        font-size: 30px;        font-weight: 300;        color: #FFD600;        cursor: pointer    }        .rating>label::before {        content: "\2605";        position: absolute;        opacity: 0    }        .rating>label:hover:before,    .rating>label:hover~label:before {        opacity: 1 !important    }        .rating>input:checked~label:before {        opacity: 1    }        .rating:hover>input:checked~label:before {        opacity: 0.4    }        </style>    <div class="row">        <div class="col-lg-12">            <div class="row">                <div class="col-lg-12">                    <h2>Відгуки</h2>                    <h4><i>Написати відгук</i></h4>                    <div class="rating_contact">                        <ul id="review_contact">                            <li>Ваше ім\'я: <span>*</span></li>                            <li><input type="text" id="reviewName"  class="input-text required-entry"  value="'.$infoUser['name'].' '.$infoUser['surName'].'"></li>                            <li>Ваша оцінка: <span>*</span></li>                            <li><div class="rating"> <input type="radio" name="rating" value="5" id="5"><label for="5">☆</label> <input type="radio" name="rating" value="4" id="4"><label for="4">☆</label> <input type="radio" name="rating" value="3" id="3"><label for="3">☆</label> <input type="radio" name="rating" value="2" id="2"><label for="2">☆</label> <input type="radio" name="rating" value="1" id="1"><label for="1">☆</label> </div></li>                            <li>Review<span>*</span></li>                            <li><textarea name="fieldReview" id="fieldReview" cols="5" rows="3" class="required-entry"></textarea></li>                        </ul>                    </div>                    <div class="alert alert-danger" style="display: none;" id="reviewEmpty">                        <strong>Помилка!</strong> Не можна відправити пусте повідомлення!                                        </div>                    <div class="alert alert-danger" style="display: none;" id="nameEmpty">                        <strong>Представтесь будь-ласка!</strong>                                        </div>                    <div class="alert alert-danger" style="display: none;" id="ratingEmpty">                        <strong>Будь-ласка поставте Вашу оцінку цьому товару!</strong>                                        </div>                    <div class="review_button">											<button type="submit" title="Відправити" onclick="sendReview('.$id.');" class="button">Відправити</button>										</div>                </div>            </div>              <div class="row">                <div class="col-lg-12">                    <div id="bodyReviews">                        '.$allReview.'                    </div>                                </div>                        </div>        </div>    </div>    ';    $html = '<style>        .rate {    border-bottom-right-radius: 12px;    border-bottom-left-radius: 12px    }        .rating {        display: flex;        flex-direction: row-reverse;        justify-content: center    }        .rating>input {        display: none    }        .rating>label {        position: relative;        width: 1em;        font-size: 30px;        font-weight: 300;        color: #FFD600;        cursor: pointer    }        .rating>label::before {        content: "\2605";        position: absolute;        opacity: 0    }        .rating>label:hover:before,    .rating>label:hover~label:before {        opacity: 1 !important    }        .rating>input:checked~label:before {        opacity: 1    }        .rating:hover>input:checked~label:before {        opacity: 0.4    }        </style>    <div class="latest-comments mb-55">     <ul>        '.$allReview.'     </ul>  </div>  <div class="product-details-comment">     <div class="comment-title mb-20">        <h3>Додати відгук</h3>        <p>Ваш email не буде опублікований*</p>     </div>     <div class="comment-rating mb-20 d-flex">        <span>Ваша оцінка</span>        <div class="rating"> <input type="radio" name="rating" value="5" id="5"><label for="5">☆</label> <input type="radio" name="rating" value="4" id="4"><label for="4">☆</label> <input type="radio" name="rating" value="3" id="3"><label for="3">☆</label> <input type="radio" name="rating" value="2" id="2"><label for="2">☆</label> <input type="radio" name="rating" value="1" id="1"><label for="1">☆</label> </div>     </div>     <div class="comment-input-box">        <form action="#">           <div class="row">              <div class="col-xxl-12">                 <div class="comment-input">                    <textarea placeholder="Ваш відгук" id="fieldReview"></textarea>                 </div>              </div>              <div class="col-xxl-12">                 <div class="comment-input">                    <input type="text" placeholder="Ваше ім\'я*" id="reviewName">                 </div>              </div>              <div class="alert alert-danger" style="display: none;" id="reviewEmpty">                    <strong>Помилка!</strong> Не можна відправити пусте повідомлення!                                    </div>                <div class="alert alert-danger" style="display: none;" id="nameEmpty">                    <strong>Представтесь будь-ласка!</strong>                                    </div>                <div class="alert alert-danger" style="display: none;" id="ratingEmpty">                    <strong>Будь-ласка поставте Вашу оцінку цьому товару!</strong>                                    </div>              <div class="col-xxl-12">                 <div class="comment-submit">                    <button type="submit" class="tp-btn pro-submit" onclick="sendReview('.$id.');">Надіслати</button>                 </div>              </div>           </div>        </form>     </div>  </div>    ';    return ($html);}function getCountReview($itemId){    if ($info = getOneString("SELECT COUNT(*) FROM `ls_reviews` WHERE `idItem` = '".$itemId."' AND `idQuestion` = 0")){        return ($info['COUNT(*)']);    } else {        return (0);    }}function liqpayStatus($status){    $array['success'] = 'Успешный платеж';    $array['failure'] = 'Неуспешный платеж';    $array['error'] = 'Неуспешный платеж. Некорректно заполнены данные';    $array['subscribed'] = 'Подписка успешно оформлена';    $array['unsubscribed'] = 'Подписка успешно деактивирована';    $array['reversed'] = 'Платеж возвращен';    $array['sandbox'] = 'Тестовый платеж';    $array['otp_verify'] = 'Требуется OTP подтверждение клиента. OTP пароль отправлен на номер телефона Клиента.';    $array['3ds_verify'] = 'Требуется 3DS верификация';    $array['cvv_verify'] = 'Требуется ввод CVV карты отправителя';    $array['sender_verify'] = 'Требуется ввод данных отправителя.';    $array['receiver_verify'] = 'Требуется ввод данных получателя.';    $array['phone_verify'] = 'Ожидается ввод телефона клиентома';    $array['ivr_verify'] = 'Ожидается подтверждение звонком ivr';    $array['pin_verify'] = 'Ожидается подтверждение pin-code';    $array['captcha_verify'] = 'Ожидается подтверждение captcha';    $array['password_verify'] = 'Ожидается подтверждение пароля приложения Приват24';    $array['senderapp_verify'] = 'Ожидается подтверждение в приложении Sender';    $array['processing'] = 'Платеж обрабатывается';    $array['prepared'] = 'Платеж создан, ожидается его завершение отправителем';    $array['wait_bitcoin'] = 'Ожидается перевод bitcoin от клиента';    $array['wait_secure'] = 'Платеж на проверке';    $array['wait_accept'] = 'Деньги с клиента списаны, но магазин еще не прошел проверку. Если магазин не пройдет активацию в течение 90 дней, платежи будут автоматически отменены';    $array['wait_lc'] = 'Аккредитив. Деньги с клиента списаны, ожидается подтверждение доставки товара';    $array['hold_wait'] = 'Сумма успешно заблокирована на счету отправителя';    $array['cash_wait'] = 'Ожидается оплата наличными в ТСО.';    $array['wait_qr'] = 'Ожидается сканирование QR-кода клиентом.';    $array['wait_sender'] = 'Ожидается подтверждение оплаты клиентом в приложении Privat24/Sender.';    $array['wait_card'] = 'Не установлен способ возмещения у получателя';    $array['wait_compensation'] = 'Платеж успешный, будет зачислен в ежесуточной проводке';    $array['invoice_wait'] = 'Инвойс создан успешно, ожидается оплата';    $array['wait_reserve'] = 'Средства по платежу зарезервированы для проведения возврата по ранее поданной заявке';    return ($array[$status]);}function getNameItem($infoItem){    if (!is_array($infoItem))        $infoItem = getOneString("SELECT * FROM `ls_items` where `id` = '".$infoItem."'");    $brand = getOneValueText($infoItem['select_3']);    if (!substr_count($infoItem['text_1'],$brand)){        return ($brand.' '.$infoItem['text_1']);    } else {        return ($infoItem['text_1']);    }}function generateItemToItemTable($id){    global $config;    if ($array = getArray("SELECT * FROM `ls_itemToItem` where `idItem` = '".$id."';")){        $toReturn = '        <table class="table table-bordered table-striped">        ';        foreach ($array as $v){            $toReturn .= '            <tr id="iti_'.$v['id'].'">                <td>'.getNameItem($v['idItem2']).'</td>                <td><a href="#" onclick="if (confirm(\'Підтвердіть видалення\')) { removeItemToItem('.$v['id'].'); } return false;"><img src="'.$config['site_url'].'images/admin/remove_16.png"></a></td>            </tr>            ';        }        $toReturn .= '</table>';        return ($toReturn);    } else {        return ('<div class="alert alert-danger">Ще немає пов\'язаних товарів');    }}function generateGiftToItemTable($id){    global $config;    if ($array = getArray("SELECT * FROM `ls_giftToItem` where `itemId` = '".$id."';")){        $toReturn = '        <table class="table table-bordered table-striped">        ';        foreach ($array as $v){            $toReturn .= '            <tr id="iti_'.$v['id'].'">                <td>'.getNameItem($v['giftId']).'</td>                <td>'.$v['price'].'</td>                <td><a href="#" onclick="if (confirm(\'Підтвердіть видалення\')) { removeGiftToItem('.$v['id'].'); } return false;"><img src="'.$config['site_url'].'images/admin/remove_16.png"></a></td>            </tr>            ';        }        $toReturn .= '</table>';        return ($toReturn);    } else {        return ('<div class="alert alert-danger">Ще немає пов\'язаних товарів');    }}function generateItemToItemTableOtherColor($id){    global $config;    if ($array = getArray("SELECT * FROM `ls_itemToItemOtherColor` where `idItem` = '".$id."';")){        $toReturn = '        <table class="table table-bordered table-striped">        ';        foreach ($array as $v){            $toReturn .= '            <tr id="iti_'.$v['id'].'">                <td>'.getNameItem($v['idItem2']).'</td>                <td><a href="#" onclick="if (confirm(\'Підтвердіть видалення\')) { removeItemToItemOtherColor('.$v['id'].'); } return false;"><img src="'.$config['site_url'].'images/admin/remove_16.png"></a></td>            </tr>            ';        }        $toReturn .= '</table>';        return ($toReturn);    } else {        return ('<div class="alert alert-danger">Ще немає пов\'язаних товарів');    }}function format_summ( $summ, $divider='.', $thousands_sep='', $zero_as_empty = false) {    $summ = str_replace(',','.', $summ);    $summ = str_replace(' ','', $summ);    return($summ);    $summ = round($summ, MONEY_PRECISION);    if($summ==0 && $zero_as_empty) {        return '';    }    $summ = number_format( floatval($summ), MONEY_PRECISION, $divider , $thousands_sep);    //if($summ=="0{$divider}00") return 0;    return $summ;}function addSelectParamValue($id, $text){    if ($info = getOneString("SELECT * FROM `ls_params_select_values` WHERE `id_params` = '".$id."' AND `text` = '".mysql_real_escape_string($text)."'")){        return ($info['id']);    } else {        $infoCount = getOneString("SELECT COUNT(*) FROM `ls_params_select_values` WHERE `id_params` = '".$id."'");        mysql_query("        INSERT INTO `ls_params_select_values` (        `id_params`,         `type_value`,         `position`,         `visible`,         `text`        ) VALUES (        '".$id."',        '1',        '".($infoCount['COUNT(*)']+1)."',        1,        '".mysql_real_escape_string($text)."'        );        ");        $idElement = mysql_insert_id();        mysql_query("INSERT INTO `ls_translate` (`type`, `id_lang`, `id_elements`, `text`) VALUES (        'select_value',         '2',         '".$idElement."',        '".mysql_real_escape_string($text)."');");        $idLang = mysql_insert_id();        mysql_query("UPDATE `ls_params_select_values` SET `id_translate` = '".$idLang."' WHERE `id` = '".$idElement."'");        return ($idElement);    }}function getImageFile($file, $width, $height, $const, $path = ''){    global $config;    if (empty ($path)){        $url_img = $config ['default_path'].'upload/userparams/'.$file;    } else {        $url_img = $config ['default_path'].urldecode($path).str_replace(' ', '+',$file);    }    $true_name = md5($url_img.$width.$height.$const);    if (!file_exists('img_small/'.$const.'_'.$true_name.'.jpg'))    {        return ($config ['site_url'] . 'resize_image.php?filename=' . urlencode($file) . '&const='.$const.'&width='.$width.'&height='.$height.'&r=255&g=255&b=255');    } else {        return ($config['site_url'].'img_small/'.$const.'_'.$true_name.'.jpg');    }}function getCategoryLink($category){    global $config;    return ($config['site_url'].'ua/shop/'.translit(getOneValue($category['id'])['text']).'/?p='.$category['id']);}function getCategoryLinkById($id){    global $config;    return ($config['site_url'].'ua/shop/'.translit(getOneValue($id)['text']).'/?p='.$id);}